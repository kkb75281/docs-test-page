<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Skapi Database Test</title>
        <link rel="stylesheet" href="style.css" />
        <style>
            body {
                font-family: Arial, sans-serif;
                max-width: 1400px;
                margin: 0 auto;
                padding: 20px;
            }
            .container {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 20px;
                margin-top: 20px;
            }
            .panel {
                border: 1px solid #ccc;
                border-radius: 8px;
                padding: 20px;
                background-color: #f9f9f9;
            }
            .panel h2 {
                margin-top: 0;
                border-bottom: 2px solid #007bff;
                padding-bottom: 10px;
            }
            .panel h3 {
                margin-top: 15px;
                color: #007bff;
                font-size: 16px;
            }
            #resultLog {
                height: 500px;
                overflow-y: auto;
                background-color: #fff;
                border: 1px solid #ddd;
                border-radius: 4px;
                padding: 10px;
                font-family: monospace;
                font-size: 12px;
            }
            .result-item {
                margin-bottom: 10px;
                padding: 8px;
                border-radius: 4px;
                border-left: 3px solid #ccc;
            }
            .result-item.success {
                background-color: #d4edda;
                border-left-color: #28a745;
            }
            .result-item.error {
                background-color: #f8d7da;
                border-left-color: #dc3545;
            }
            .result-item.info {
                background-color: #d1ecf1;
                border-left-color: #17a2b8;
            }
            button {
                padding: 8px 16px;
                margin: 5px 5px 5px 0;
                border: none;
                border-radius: 4px;
                background-color: #007bff;
                color: white;
                font-size: 14px;
                cursor: pointer;
            }
            button:hover {
                background-color: #0056b3;
            }
            button:disabled {
                background-color: #6c757d;
                cursor: not-allowed;
            }
            button.danger {
                background-color: #dc3545;
            }
            button.danger:hover {
                background-color: #c82333;
            }
            button.success {
                background-color: #28a745;
            }
            button.success:hover {
                background-color: #218838;
            }
            input[type="text"],
            input[type="number"],
            textarea,
            select {
                width: 100%;
                padding: 8px;
                border: 1px solid #ccc;
                border-radius: 4px;
                font-size: 14px;
                box-sizing: border-box;
            }
            textarea {
                min-height: 60px;
                font-family: monospace;
            }
            .form-group {
                margin-bottom: 15px;
            }
            .form-group label {
                display: block;
                margin-bottom: 5px;
                font-weight: bold;
                font-size: 13px;
            }
            .user-info {
                background-color: #e9ecef;
                padding: 10px;
                border-radius: 4px;
                margin-bottom: 15px;
                font-size: 14px;
            }
            .tabs {
                display: flex;
                border-bottom: 2px solid #ddd;
                margin-bottom: 15px;
            }
            .tab {
                padding: 10px 20px;
                cursor: pointer;
                border: none;
                background: none;
                font-size: 14px;
                font-weight: bold;
                color: #666;
                margin: 0;
                border-radius: 0;
            }
            .tab.active {
                color: #007bff;
                border-bottom: 2px solid #007bff;
            }
            .tab-content {
                display: none;
            }
            .tab-content.active {
                display: block;
            }
            .inline-group {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 10px;
            }
        </style>
    </head>
    <body>
        <a class="btn home" href="/index.html">í™ˆìœ¼ë¡œ</a>
        <h1>ğŸ—„ï¸ Skapi Database Test</h1>

        <div class="user-info">
            <strong>Logged User:</strong>
            <span id="loggedUser">Not logged in</span>
        </div>

        <!-- Test Guide Panel -->
        <div
            class="panel"
            style="background-color: #fff3cd; border-color: #ffc107"
        >
            <h2>ğŸ“‹ í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ</h2>
            <details>
                <summary
                    style="
                        cursor: pointer;
                        font-weight: bold;
                        margin-bottom: 10px;
                    "
                >
                    ğŸ¯ ê¸°ë³¸ CRUD í…ŒìŠ¤íŠ¸ ìˆœì„œ
                </summary>
                <ol style="line-height: 1.8">
                    <li>
                        <strong>Create (ìƒì„±)</strong>
                        <ul>
                            <li>
                                Dataì—
                                <code>{"name": "í…ŒìŠ¤íŠ¸", "age": 25}</code> ì…ë ¥
                            </li>
                            <li>Table Name: <code>users</code></li>
                            <li>Access Group: <code>public</code> ì„ íƒ</li>
                            <li>"Create Record" ë²„íŠ¼ í´ë¦­ â†’ record_id í™•ì¸</li>
                        </ul>
                    </li>
                    <li>
                        <strong>Read (ì¡°íšŒ)</strong>
                        <ul>
                            <li>Read íƒ­ìœ¼ë¡œ ì´ë™</li>
                            <li>Table Name: <code>users</code></li>
                            <li>Access Group: <code>public</code></li>
                            <li>
                                "Get Records" í´ë¦­ â†’ ë°©ê¸ˆ ìƒì„±í•œ ë°ì´í„° í™•ì¸
                            </li>
                        </ul>
                    </li>
                    <li>
                        <strong>Update (ìˆ˜ì •)</strong>
                        <ul>
                            <li>Update íƒ­ìœ¼ë¡œ ì´ë™</li>
                            <li>Record IDì— ìƒì„±ëœ record_id ë¶™ì—¬ë„£ê¸°</li>
                            <li>
                                New Data:
                                <code>{"name": "ìˆ˜ì •ë¨", "age": 30}</code>
                            </li>
                            <li>"Update Record" í´ë¦­ â†’ ìˆ˜ì • í™•ì¸</li>
                            <li>
                                âš ï¸ <strong>ì£¼ì˜:</strong> New DataëŠ” ë°˜ë“œì‹œ
                                ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤ (ë¹ˆ ê°’ ë¶ˆê°€)
                            </li>
                            <li>
                                âš ï¸ <strong>ì£¼ì˜:</strong> Access Group ë³€ê²½ ì‹œ
                                ê¶Œí•œ ì—ëŸ¬ ë°œìƒ ê°€ëŠ¥ (ë³€ê²½í•˜ì§€ ë§ ê²ƒ)
                            </li>
                        </ul>
                    </li>
                    <li>
                        <strong>Delete (ì‚­ì œ)</strong>
                        <ul>
                            <li>Delete íƒ­ìœ¼ë¡œ ì´ë™</li>
                            <li>Record IDsì— record_id ë¶™ì—¬ë„£ê¸°</li>
                            <li>"Delete Records" í´ë¦­ â†’ ì‚­ì œ í™•ì¸</li>
                        </ul>
                    </li>
                </ol>
            </details>

            <details style="margin-top: 15px">
                <summary
                    style="
                        cursor: pointer;
                        font-weight: bold;
                        margin-bottom: 10px;
                    "
                >
                    ğŸ” ì¸ë±ì‹± & ê²€ìƒ‰ í…ŒìŠ¤íŠ¸
                </summary>
                <ol style="line-height: 1.8">
                    <li>
                        <strong>ì¸ë±ìŠ¤ë¡œ ë ˆì½”ë“œ ìƒì„±</strong>
                        <ul>
                            <li>
                                Create íƒ­ì—ì„œ Data:
                                <code>{"title": "2024ë…„ ê³„íš"}</code>
                            </li>
                            <li>Index Name: <code>year</code></li>
                            <li>Index Value: <code>2024</code></li>
                            <li>Create Record í´ë¦­</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ì—¬ëŸ¬ ì—°ë„ ë°ì´í„° ìƒì„±</strong>
                        <ul>
                            <li>ê°™ì€ ë°©ì‹ìœ¼ë¡œ 2023, 2025, 2026 ë°ì´í„° ìƒì„±</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ë²”ìœ„ ê²€ìƒ‰</strong>
                        <ul>
                            <li>Read íƒ­ì—ì„œ Index Name: <code>year</code></li>
                            <li>
                                Index Value: <code>2024</code>, Condition:
                                <code>>=</code>
                            </li>
                            <li>Get Records â†’ 2024 ì´ìƒë§Œ ì¡°íšŒë¨</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ì •í™•í•œ ê°’ ê²€ìƒ‰</strong>
                        <ul>
                            <li>Conditionì„ <code>=</code>ë¡œ ë³€ê²½</li>
                            <li>Get Records â†’ 2024ë§Œ ì¡°íšŒë¨</li>
                        </ul>
                    </li>
                </ol>
            </details>

            <details style="margin-top: 15px">
                <summary
                    style="
                        cursor: pointer;
                        font-weight: bold;
                        margin-bottom: 10px;
                    "
                >
                    ğŸ·ï¸ íƒœê·¸ í…ŒìŠ¤íŠ¸
                </summary>
                <ol style="line-height: 1.8">
                    <li>
                        <strong>íƒœê·¸ë¡œ ë ˆì½”ë“œ ìƒì„±</strong>
                        <ul>
                            <li>
                                Create íƒ­ì—ì„œ Data:
                                <code>{"content": "ì¤‘ìš” ê³µì§€"}</code>
                            </li>
                            <li>Tags: <code>ê³µì§€, ì¤‘ìš”, í•„ë…</code></li>
                            <li>Create Record í´ë¦­</li>
                        </ul>
                    </li>
                    <li>
                        <strong>íƒœê·¸ë¡œ ê²€ìƒ‰</strong>
                        <ul>
                            <li>Read íƒ­ì—ì„œ Tag: <code>ì¤‘ìš”</code></li>
                            <li>Get Records â†’ í•´ë‹¹ íƒœê·¸ í¬í•¨ ë ˆì½”ë“œë§Œ ì¡°íšŒ</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ëª¨ë“  íƒœê·¸ í™•ì¸</strong>
                        <ul>
                            <li>Advanced Features â†’ Info íƒ­</li>
                            <li>"Get Tags" í´ë¦­ â†’ ëª¨ë“  íƒœê·¸ ëª©ë¡ í™•ì¸</li>
                        </ul>
                    </li>
                </ol>
            </details>

            <details style="margin-top: 15px">
                <summary
                    style="
                        cursor: pointer;
                        font-weight: bold;
                        margin-bottom: 10px;
                    "
                >
                    ğŸ”— ë ˆí¼ëŸ°ìŠ¤ í…ŒìŠ¤íŠ¸
                </summary>
                <ol style="line-height: 1.8">
                    <li>
                        <strong>ë¶€ëª¨ ë ˆì½”ë“œ ìƒì„±</strong>
                        <ul>
                            <li>
                                Create íƒ­ì—ì„œ Data:
                                <code>{"type": "ë¶€ëª¨"}</code>
                            </li>
                            <li>Table: <code>posts</code></li>
                            <li>Create â†’ record_id ë³µì‚¬</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ìì‹ ë ˆì½”ë“œ ìƒì„± (ëŒ“ê¸€)</strong>
                        <ul>
                            <li>
                                Data:
                                <code
                                    >{"type": "ëŒ“ê¸€", "text": "ì¢‹ì€
                                    ê¸€ì´ë„¤ìš”"}</code
                                >
                            </li>
                            <li>
                                Reference Record IDì— ë¶€ëª¨ record_id ë¶™ì—¬ë„£ê¸°
                            </li>
                            <li>Create Record</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ë ˆí¼ëŸ°ìŠ¤ë¡œ ì¡°íšŒ</strong>
                        <ul>
                            <li>Read íƒ­ì—ì„œ Referenceì— ë¶€ëª¨ record_id ì…ë ¥</li>
                            <li>Get Records â†’ í•´ë‹¹ ê²Œì‹œë¬¼ì˜ ëª¨ë“  ëŒ“ê¸€ ì¡°íšŒ</li>
                        </ul>
                    </li>
                </ol>
            </details>

            <details style="margin-top: 15px">
                <summary
                    style="
                        cursor: pointer;
                        font-weight: bold;
                        margin-bottom: 10px;
                    "
                >
                    ğŸ“ íŒŒì¼ ì—…ë¡œë“œ í…ŒìŠ¤íŠ¸
                </summary>
                <ol style="line-height: 1.8">
                    <li>
                        <strong>íŒŒì¼ ì—…ë¡œë“œ</strong>
                        <ul>
                            <li>Files íƒ­ìœ¼ë¡œ ì´ë™</li>
                            <li>Table Name: <code>my_files</code></li>
                            <li>Description: <code>í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€</code></li>
                            <li>Filesì—ì„œ ì´ë¯¸ì§€/ë¬¸ì„œ ì„ íƒ</li>
                            <li>"Upload Files" í´ë¦­ â†’ ì§„í–‰ë¥  í™•ì¸</li>
                            <li>ì—…ë¡œë“œ ì™„ë£Œ í›„ record_id ë³µì‚¬</li>
                        </ul>
                    </li>
                    <li>
                        <strong>íŒŒì¼ ë‹¤ìš´ë¡œë“œ</strong>
                        <ul>
                            <li>
                                Download File by Record IDì— record_id ë¶™ì—¬ë„£ê¸°
                            </li>
                            <li>
                                "Get Files" í´ë¦­ â†’ íŒŒì¼ ì •ë³´ í™•ì¸ ë° ë‹¤ìš´ë¡œë“œ
                            </li>
                        </ul>
                    </li>
                </ol>
            </details>

            <details style="margin-top: 15px">
                <summary
                    style="
                        cursor: pointer;
                        font-weight: bold;
                        margin-bottom: 10px;
                    "
                >
                    ï¿½ Source Options (ì°¸ì¡° ì œì•½) í…ŒìŠ¤íŠ¸
                </summary>

                <h4 style="color: #007bff; margin-top: 10px">
                    1ï¸âƒ£ Referencing Limit (ì°¸ì¡° ê°œìˆ˜ ì œí•œ)
                </h4>
                <ol style="line-height: 1.8">
                    <li>
                        <strong>ì œí•œëœ ì°¸ì¡° ë ˆì½”ë“œ ìƒì„±</strong>
                        <ul>
                            <li>
                                Create íƒ­ì—ì„œ Data:
                                <code>{"title": "í•œì • ìƒí’ˆ"}</code>
                            </li>
                            <li>Table: <code>limited_products</code></li>
                            <li>
                                Referencing Limit: <code>3</code> (ìµœëŒ€ 3ê°œë§Œ
                                ì°¸ì¡° ê°€ëŠ¥)
                            </li>
                            <li>Create Record â†’ record_id ë³µì‚¬</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ì°¸ì¡° ë ˆì½”ë“œ 3ê°œ ìƒì„±</strong>
                        <ul>
                            <li>Data: <code>{"order": "ì£¼ë¬¸1"}</code></li>
                            <li>Reference Record IDì— ìœ„ record_id ë¶™ì—¬ë„£ê¸°</li>
                            <li>
                                Create Record 3ë²ˆ ë°˜ë³µ (ì£¼ë¬¸1, ì£¼ë¬¸2, ì£¼ë¬¸3)
                            </li>
                        </ul>
                    </li>
                    <li>
                        <strong>4ë²ˆì§¸ ì°¸ì¡° ì‹œë„ â†’ ì—ëŸ¬ í™•ì¸</strong>
                        <ul>
                            <li>ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì£¼ë¬¸4 ìƒì„± ì‹œë„</li>
                            <li>âŒ ì°¸ì¡° ì œí•œ ì´ˆê³¼ ì—ëŸ¬ ë°œìƒ í™•ì¸</li>
                        </ul>
                    </li>
                </ol>

                <h4 style="color: #007bff; margin-top: 15px">
                    2ï¸âƒ£ Prevent Multiple Referencing (ì¤‘ë³µ ì°¸ì¡° ë°©ì§€)
                </h4>
                <ol style="line-height: 1.8">
                    <li>
                        <strong>ì¤‘ë³µ ë°©ì§€ ë ˆì½”ë“œ ìƒì„±</strong>
                        <ul>
                            <li>
                                Data: <code>{"event": "ì„ ì°©ìˆœ ì´ë²¤íŠ¸"}</code>
                            </li>
                            <li>Table: <code>events</code></li>
                            <li>âœ… Prevent Multiple Referencing ì²´í¬</li>
                            <li>Create Record â†’ record_id ë³µì‚¬</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ì²« ë²ˆì§¸ ì°¸ì—¬ ë ˆì½”ë“œ ìƒì„±</strong>
                        <ul>
                            <li>Data: <code>{"participant": "ì°¸ì—¬"}</code></li>
                            <li>Reference Record IDì— event record_id ì…ë ¥</li>
                            <li>Create Record â†’ âœ… ì„±ê³µ</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ê°™ì€ ì‚¬ìš©ìê°€ ë‘ ë²ˆì§¸ ì°¸ì—¬ ì‹œë„</strong>
                        <ul>
                            <li>ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ ë‹¤ì‹œ ì°¸ì—¬ ë ˆì½”ë“œ ìƒì„± ì‹œë„</li>
                            <li>âŒ ì´ë¯¸ ì°¸ì¡°í–ˆë‹¤ëŠ” ì—ëŸ¬ ë°œìƒ í™•ì¸</li>
                        </ul>
                    </li>
                </ol>

                <h4 style="color: #007bff; margin-top: 15px">
                    3ï¸âƒ£ Only Granted Can Reference (ê¶Œí•œìë§Œ ì°¸ì¡°)
                </h4>
                <ol style="line-height: 1.8">
                    <li>
                        <strong>Private ë ˆì½”ë“œì— ê¶Œí•œ ì œí•œ ì„¤ì •</strong>
                        <ul>
                            <li>Data: <code>{"content": "VIP ì „ìš©"}</code></li>
                            <li>Table: <code>vip_posts</code></li>
                            <li>Access Group: <code>private</code></li>
                            <li>âœ… Only Granted Can Reference ì²´í¬</li>
                            <li>Create Record â†’ record_id ë³µì‚¬</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ê¶Œí•œ ë¶€ì—¬</strong>
                        <ul>
                            <li>Advanced Features â†’ Access íƒ­</li>
                            <li>Record IDì— ìœ„ record_id ì…ë ¥</li>
                            <li>User ID to Grantì— íŠ¹ì • ì‚¬ìš©ì ID ì…ë ¥</li>
                            <li>Grant Private Access í´ë¦­</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ê¶Œí•œ ìˆëŠ” ì‚¬ìš©ìë¡œ ì°¸ì¡° í…ŒìŠ¤íŠ¸</strong>
                        <ul>
                            <li>ê¶Œí•œ ë¶€ì—¬ë°›ì€ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸</li>
                            <li>
                                Reference Record IDì— VIP ë ˆì½”ë“œ ID ì…ë ¥í•˜ì—¬
                                ìƒì„± â†’ âœ… ì„±ê³µ
                            </li>
                        </ul>
                    </li>
                    <li>
                        <strong>ê¶Œí•œ ì—†ëŠ” ì‚¬ìš©ìë¡œ ì°¸ì¡° ì‹œë„</strong>
                        <ul>
                            <li>ë‹¤ë¥¸ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•˜ì—¬ ì°¸ì¡° ì‹œë„</li>
                            <li>âŒ ê¶Œí•œ ì—†ìŒ ì—ëŸ¬ ë°œìƒ í™•ì¸</li>
                        </ul>
                    </li>
                </ol>

                <h4 style="color: #007bff; margin-top: 15px">
                    4ï¸âƒ£ Can Remove Referencing Records (ì°¸ì¡° ë ˆì½”ë“œ ì‚­ì œ)
                </h4>
                <ol style="line-height: 1.8">
                    <li>
                        <strong>ì—°ì‡„ ì‚­ì œ ë ˆì½”ë“œ ìƒì„±</strong>
                        <ul>
                            <li>Data: <code>{"post": "ê³µì§€ì‚¬í•­"}</code></li>
                            <li>Table: <code>notices</code></li>
                            <li>âœ… Can Remove Referencing Records ì²´í¬</li>
                            <li>Create Record â†’ record_id ë³µì‚¬</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ì°¸ì¡° ë ˆì½”ë“œ ì—¬ëŸ¬ ê°œ ìƒì„±</strong>
                        <ul>
                            <li>Data: <code>{"comment": "ëŒ“ê¸€1"}</code></li>
                            <li>
                                Reference Record IDì— ê³µì§€ì‚¬í•­ record_id ì…ë ¥
                            </li>
                            <li>
                                Create Record 3ë²ˆ ë°˜ë³µ (ëŒ“ê¸€1, ëŒ“ê¸€2, ëŒ“ê¸€3)
                            </li>
                        </ul>
                    </li>
                    <li>
                        <strong>ë¶€ëª¨ ë ˆì½”ë“œ ì‚­ì œ</strong>
                        <ul>
                            <li>Delete íƒ­ì—ì„œ ê³µì§€ì‚¬í•­ record_id ì…ë ¥</li>
                            <li>Delete Records í´ë¦­</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ì°¸ì¡° ë ˆì½”ë“œ ìë™ ì‚­ì œ í™•ì¸</strong>
                        <ul>
                            <li>
                                Read íƒ­ì—ì„œ Table: <code>notices</code> ì¡°íšŒ
                            </li>
                            <li>âœ… ëŒ“ê¸€ë“¤ë„ í•¨ê»˜ ì‚­ì œëœ ê²ƒ í™•ì¸</li>
                        </ul>
                    </li>
                </ol>

                <h4 style="color: #007bff; margin-top: 15px">
                    5ï¸âƒ£ Allow Granted to Grant Others (ê¶Œí•œ ì¬ë¶€ì—¬)
                </h4>
                <ol style="line-height: 1.8">
                    <li>
                        <strong>ê¶Œí•œ ì¬ë¶€ì—¬ ê°€ëŠ¥ ë ˆì½”ë“œ ìƒì„±</strong>
                        <ul>
                            <li>Data: <code>{"document": "ê¸°ë°€ë¬¸ì„œ"}</code></li>
                            <li>Access Group: <code>private</code></li>
                            <li>âœ… Only Granted Can Reference ì²´í¬</li>
                            <li>âœ… Allow Granted to Grant Others ì²´í¬</li>
                            <li>Create Record â†’ record_id ë³µì‚¬</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ì‚¬ìš©ì Aì—ê²Œ ê¶Œí•œ ë¶€ì—¬</strong>
                        <ul>
                            <li>Advanced Features â†’ Access íƒ­</li>
                            <li>
                                Grant Private Accessë¡œ ì‚¬ìš©ì Aì—ê²Œ ê¶Œí•œ ë¶€ì—¬
                            </li>
                        </ul>
                    </li>
                    <li>
                        <strong>ì‚¬ìš©ì Aê°€ ì‚¬ìš©ì Bì—ê²Œ ê¶Œí•œ ì¬ë¶€ì—¬</strong>
                        <ul>
                            <li>ì‚¬ìš©ì A ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸</li>
                            <li>
                                ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©ì Bì—ê²Œ Grant Private
                                Access
                            </li>
                            <li>âœ… ê¶Œí•œ ì¬ë¶€ì—¬ ì„±ê³µ í™•ì¸</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ì‚¬ìš©ì Bê°€ ì°¸ì¡° ê°€ëŠ¥í•œì§€ í™•ì¸</strong>
                        <ul>
                            <li>ì‚¬ìš©ì B ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸</li>
                            <li>ê¸°ë°€ë¬¸ì„œë¥¼ ì°¸ì¡°í•˜ëŠ” ë ˆì½”ë“œ ìƒì„± â†’ âœ… ì„±ê³µ</li>
                        </ul>
                    </li>
                </ol>

                <h4 style="color: #007bff; margin-top: 15px">
                    6ï¸âƒ£ Referencing Index Restrictions (ì¸ë±ìŠ¤ ì œì•½)
                </h4>
                <ol style="line-height: 1.8">
                    <li>
                        <strong>ì¸ë±ìŠ¤ ì œì•½ ë ˆì½”ë“œ ìƒì„±</strong>
                        <ul>
                            <li>
                                Data: <code>{"product": "í”„ë¦¬ë¯¸ì—„ ìƒí’ˆ"}</code>
                            </li>
                            <li>Table: <code>premium_products</code></li>
                            <li>
                                Index Name: <code>status</code>, Value:
                                <code>active</code>
                            </li>
                            <li>
                                Referencing Index Restrictions:
                                <code
                                    >[{"name": "level", "value": "premium",
                                    "condition": "="}]</code
                                >
                            </li>
                            <li>Create Record â†’ record_id ë³µì‚¬</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ì¡°ê±´ ë§Œì¡±í•˜ëŠ” ë ˆì½”ë“œë¡œ ì°¸ì¡° (ì„±ê³µ)</strong>
                        <ul>
                            <li>Data: <code>{"review": "ì¢‹ì•„ìš”"}</code></li>
                            <li>
                                Index Name: <code>level</code>, Value:
                                <code>premium</code>
                            </li>
                            <li>Reference Record IDì— ìƒí’ˆ record_id ì…ë ¥</li>
                            <li>Create Record â†’ âœ… ì„±ê³µ</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ì¡°ê±´ ë¶ˆë§Œì¡± ë ˆì½”ë“œë¡œ ì°¸ì¡° ì‹œë„ (ì‹¤íŒ¨)</strong>
                        <ul>
                            <li>Data: <code>{"review": "ë³„ë¡œ"}</code></li>
                            <li>
                                Index Name: <code>level</code>, Value:
                                <code>basic</code>
                            </li>
                            <li>
                                Reference Record IDì— ë™ì¼í•œ ìƒí’ˆ record_id ì…ë ¥
                            </li>
                            <li>Create Record â†’ âŒ ì¸ë±ìŠ¤ ì œì•½ ìœ„ë°˜ ì—ëŸ¬</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ë²”ìœ„ ì¡°ê±´ í…ŒìŠ¤íŠ¸</strong>
                        <ul>
                            <li>
                                ìƒˆ ìƒí’ˆ: Restrictions:
                                <code
                                    >[{"name": "age", "value": 18, "condition":
                                    ">="}]</code
                                >
                            </li>
                            <li>age >= 18ì¸ ë ˆì½”ë“œë¡œ ì°¸ì¡° â†’ âœ… ì„±ê³µ</li>
                            <li>age < 18ì¸ ë ˆì½”ë“œë¡œ ì°¸ì¡° â†’ âŒ ì‹¤íŒ¨</li>
                        </ul>
                    </li>
                </ol>

                <h4 style="color: #28a745; margin-top: 15px">
                    ğŸ’¡ ë³µí•© í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤
                </h4>
                <ol style="line-height: 1.8">
                    <li>
                        <strong>í•œì •íŒ VIP ì´ë²¤íŠ¸</strong>
                        <ul>
                            <li>Referencing Limit: 10</li>
                            <li>âœ… Prevent Multiple Referencing</li>
                            <li>âœ… Only Granted Can Reference</li>
                            <li>
                                Restrictions:
                                <code
                                    >[{"name": "membership", "value":
                                    "vip"}]</code
                                >
                            </li>
                            <li>â†’ VIPë§Œ, 1ì¸ë‹¹ 1ë²ˆ, ìµœëŒ€ 10ëª…ë§Œ ì°¸ì—¬ ê°€ëŠ¥</li>
                        </ul>
                    </li>
                    <li>
                        <strong>í”„ë¡œì íŠ¸ ê´€ë¦¬ ì‹œìŠ¤í…œ</strong>
                        <ul>
                            <li>
                                í”„ë¡œì íŠ¸: Can Remove Referencing Records
                                (í”„ë¡œì íŠ¸ ì‚­ì œ ì‹œ ëª¨ë“  ì‘ì—… ì‚­ì œ)
                            </li>
                            <li>
                                ì‘ì—…: Restrictions:
                                <code
                                    >[{"name": "status", "value":
                                    "assigned"}]</code
                                >
                            </li>
                            <li>â†’ í• ë‹¹ëœ ì‘ì—…ë§Œ í”„ë¡œì íŠ¸ì— ì—°ê²° ê°€ëŠ¥</li>
                        </ul>
                    </li>
                </ol>
            </details>

            <details style="margin-top: 15px">
                <summary
                    style="
                        cursor: pointer;
                        font-weight: bold;
                        margin-bottom: 10px;
                    "
                >
                    ï¿½ğŸ“° êµ¬ë… ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸
                </summary>
                <ol style="line-height: 1.8">
                    <li>
                        <strong>1ë‹¨ê³„: B ê³„ì •ìœ¼ë¡œ A êµ¬ë…í•˜ê¸° (ì¤‘ìš”!)</strong>
                        <ul>
                            <li>
                                âš ï¸
                                <strong>ë¨¼ì € êµ¬ë…ì„ í•´ì•¼ í•©ë‹ˆë‹¤!</strong> (êµ¬ë…
                                ì „ ë ˆì½”ë“œëŠ” í”¼ë“œì— í‘œì‹œ ì•ˆ ë¨)
                            </li>
                            <li>B ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸</li>
                            <li>Advanced Features â†’ Subscription íƒ­</li>
                            <li>User ID to Subscribeì— Aì˜ user_id ì…ë ¥</li>
                            <li>"Subscribe" í´ë¦­</li>
                            <li>"Get My Subscriptions" í´ë¦­í•˜ì—¬ êµ¬ë… í™•ì¸</li>
                        </ul>
                    </li>
                    <li>
                        <strong>2ë‹¨ê³„: Aê°€ êµ¬ë…ìš© ë ˆì½”ë“œ ìƒì„±</strong>
                        <ul>
                            <li>A ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸</li>
                            <li>
                                Create íƒ­ì—ì„œ Data:
                                <code>{"title": "ì²« ë²ˆì§¸ í”¼ë“œ"}</code>
                            </li>
                            <li>
                                Table: <code>feed</code> (ë˜ëŠ” ì›í•˜ëŠ” í…Œì´ë¸”ëª…)
                            </li>
                            <li>
                                Access Group: <code>public</code> ë˜ëŠ”
                                <code>authorized</code>
                            </li>
                            <li>
                                âœ… <strong>Is Subscription Record</strong> ì²´í¬
                                (í•„ìˆ˜!)
                            </li>
                            <li>
                                âœ… <strong>Upload to Feed</strong> ì²´í¬ (í•„ìˆ˜!)
                            </li>
                            <li>âœ… Notify Subscribers ì²´í¬ (ì„ íƒ)</li>
                            <li>Create Record í´ë¦­</li>
                        </ul>
                    </li>
                    <li>
                        <strong>3ë‹¨ê³„: Bê°€ í”¼ë“œ í™•ì¸</strong>
                        <ul>
                            <li>B ê³„ì •ìœ¼ë¡œ ë‹¤ì‹œ ë¡œê·¸ì¸</li>
                            <li>Advanced Features â†’ Subscription íƒ­</li>
                            <li>"Get My Feed" í´ë¦­ â†’ Aì˜ ê²Œì‹œë¬¼ í™•ì¸</li>
                            <li>
                                ğŸ’¡ Fetch More ì²´í¬í•˜ë©´ ë” ë§ì€ í”¼ë“œ ë¡œë“œ ê°€ëŠ¥
                            </li>
                        </ul>
                    </li>
                    <li>
                        <strong>4ë‹¨ê³„: ì¶”ê°€ í”¼ë“œ í…ŒìŠ¤íŠ¸</strong>
                        <ul>
                            <li>A ê³„ì •ìœ¼ë¡œ ë™ì¼í•œ ì„¤ì •ìœ¼ë¡œ ë ˆì½”ë“œ ì¶”ê°€ ìƒì„±</li>
                            <li>
                                B ê³„ì •ì—ì„œ "Get My Feed" â†’ ìƒˆ ê²Œì‹œë¬¼ë„ í•¨ê»˜ í‘œì‹œ
                            </li>
                        </ul>
                    </li>
                    <li>
                        <strong>5ë‹¨ê³„: êµ¬ë… ì·¨ì†Œ ë° ì°¨ë‹¨</strong>
                        <ul>
                            <li>"Unsubscribe" â†’ êµ¬ë… ì·¨ì†Œ</li>
                            <li>
                                "Get My Feed" â†’ Aì˜ ê²Œì‹œë¬¼ ë” ì´ìƒ í‘œì‹œ ì•ˆ ë¨
                            </li>
                            <li>
                                ë˜ëŠ” Aê°€ Bë¥¼ ì°¨ë‹¨: Block User IDì— Bì˜ user_id
                                ì…ë ¥ â†’ "Block Subscriber" â†’ ì°¨ë‹¨
                            </li>
                        </ul>
                    </li>
                </ol>

                <div
                    style="
                        background-color: #fff3cd;
                        border: 1px solid #ffc107;
                        border-radius: 4px;
                        padding: 10px;
                        margin-top: 10px;
                    "
                >
                    <strong>âš ï¸ ì¤‘ìš” í¬ì¸íŠ¸:</strong>
                    <ul style="margin: 5px 0">
                        <li>
                            <strong>êµ¬ë… ìˆœì„œ:</strong> ë°˜ë“œì‹œ êµ¬ë… ë¨¼ì € â†’ ê·¸
                            ì´í›„ ìƒì„±ëœ ë ˆì½”ë“œë§Œ í”¼ë“œì— í‘œì‹œ
                        </li>
                        <li>
                            <strong>í•„ìˆ˜ ì²´í¬ë°•ìŠ¤:</strong> "Is Subscription
                            Record" + "Upload to Feed" ë‘˜ ë‹¤ ì²´í¬
                        </li>
                        <li>
                            <strong>í…Œì´ë¸”ëª…:</strong> ì–´ë–¤ í…Œì´ë¸”ëª…ì´ë“  ê°€ëŠ¥
                            (ì˜ˆ: posts, feed, articles ë“±)
                        </li>
                        <li>
                            <strong>Access Group:</strong> public ë˜ëŠ”
                            authorized ê¶Œì¥
                        </li>
                        <li>
                            <strong>êµ¬ë… ì·¨ì†Œ:</strong> êµ¬ë… ì·¨ì†Œ ì‹œ ê³¼ê±° í”¼ë“œë„
                            ëª¨ë‘ ì‚¬ë¼ì§
                        </li>
                    </ul>
                </div>

                <div
                    style="
                        background-color: #f8d7da;
                        border: 1px solid #dc3545;
                        border-radius: 4px;
                        padding: 10px;
                        margin-top: 10px;
                    "
                >
                    <strong>ğŸ” ë¬¸ì œ í•´ê²°:</strong>
                    <ul style="margin: 5px 0">
                        <li>
                            <strong>í”¼ë“œê°€ ì•ˆ ë³´ì¼ ë•Œ:</strong>
                            <ol>
                                <li>
                                    "Debug: Check Subscription Status" í´ë¦­ â†’
                                    êµ¬ë… ìƒíƒœ í™•ì¸
                                </li>
                                <li>
                                    "Debug: Check Feed Records" í´ë¦­ â†’ ë ˆì½”ë“œê°€
                                    ì œëŒ€ë¡œ ìƒì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸
                                </li>
                                <li>
                                    ë‘ ì²´í¬ë°•ìŠ¤(Is Subscription + Upload to
                                    Feed)ê°€ ëª¨ë‘ ì²´í¬ë˜ì—ˆëŠ”ì§€ í™•ì¸
                                </li>
                                <li>
                                    êµ¬ë…í•œ ì´í›„ì— ë ˆì½”ë“œê°€ ìƒì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸
                                </li>
                            </ol>
                        </li>
                    </ul>
                </div>
            </details>

            <details style="margin-top: 15px">
                <summary
                    style="
                        cursor: pointer;
                        font-weight: bold;
                        margin-bottom: 10px;
                    "
                >
                    ğŸ” í”„ë¼ì´ë¹— ì ‘ê·¼ ê´€ë¦¬ í…ŒìŠ¤íŠ¸
                </summary>
                <ol style="line-height: 1.8">
                    <li>
                        <strong>Private ë ˆì½”ë“œ ìƒì„±</strong>
                        <ul>
                            <li>
                                Create íƒ­ì—ì„œ Data:
                                <code>{"secret": "ë¹„ë°€ì •ë³´"}</code>
                            </li>
                            <li>Access Group: <code>private</code> ì„ íƒ</li>
                            <li>Create Record â†’ record_id ë³µì‚¬</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ì ‘ê·¼ ê¶Œí•œ ë¶€ì—¬</strong>
                        <ul>
                            <li>Advanced Features â†’ Access íƒ­</li>
                            <li>Record IDì— private record_id ì…ë ¥</li>
                            <li>User ID to Grantì— ì ‘ê·¼ í—ˆìš©í•  user_id ì…ë ¥</li>
                            <li>"Grant Private Access" í´ë¦­</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ì ‘ê·¼ ëª©ë¡ í™•ì¸</strong>
                        <ul>
                            <li>
                                "List Private Access Grants" â†’ ëˆ„ê°€ ì ‘ê·¼
                                ê°€ëŠ¥í•œì§€ í™•ì¸
                            </li>
                        </ul>
                    </li>
                    <li>
                        <strong>ì ‘ê·¼ ê¶Œí•œ ì œê±°</strong>
                        <ul>
                            <li>"Remove Private Access" í´ë¦­ â†’ ê¶Œí•œ ì œê±°</li>
                        </ul>
                    </li>
                </ol>
            </details>

            <details style="margin-top: 15px">
                <summary
                    style="
                        cursor: pointer;
                        font-weight: bold;
                        margin-bottom: 10px;
                    "
                >
                    ğŸ“Š ë°ì´í„°ë² ì´ìŠ¤ ì •ë³´ ì¡°íšŒ
                </summary>
                <ol style="line-height: 1.8">
                    <li>
                        <strong>ëª¨ë“  í…Œì´ë¸” í™•ì¸</strong>
                        <ul>
                            <li>Advanced Features â†’ Info íƒ­</li>
                            <li>"Get All Tables" â†’ ìƒì„±ëœ ëª¨ë“  í…Œì´ë¸” ëª©ë¡</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ì¸ë±ìŠ¤ ì •ë³´</strong>
                        <ul>
                            <li>"Get Indexes" â†’ ëª¨ë“  ì¸ë±ìŠ¤ ëª©ë¡</li>
                            <li>
                                íŠ¹ì • ì¸ë±ìŠ¤ ìƒì„¸ ì •ë³´: Table Nameê³¼ Index Name
                                ì…ë ¥ í›„ "Get Index Info"
                            </li>
                        </ul>
                    </li>
                    <li>
                        <strong>Unique ID ì¡°íšŒ</strong>
                        <ul>
                            <li>
                                Get Unique IDs starting withì— prefix ì…ë ¥ (ì˜ˆ:
                                <code>user_</code>)
                            </li>
                            <li>
                                "Get Unique IDs" â†’ í•´ë‹¹ prefixë¡œ ì‹œì‘í•˜ëŠ” ëª¨ë“ 
                                unique_id
                            </li>
                        </ul>
                    </li>
                </ol>
            </details>

            <details style="margin-top: 15px">
                <summary
                    style="
                        cursor: pointer;
                        font-weight: bold;
                        margin-bottom: 10px;
                    "
                >
                    ğŸ¨ ê³ ê¸‰ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸
                </summary>
                <ol style="line-height: 1.8">
                    <li>
                        <strong>ë¸”ë¡œê·¸ ì‹œìŠ¤í…œ ì‹œë®¬ë ˆì´ì…˜</strong>
                        <ul>
                            <li>
                                ê²Œì‹œë¬¼ ìƒì„±: table=<code>blog_posts</code>,
                                index=<code>category</code>, tags=<code
                                    >ê°œë°œ,íŠœí† ë¦¬ì–¼</code
                                >
                            </li>
                            <li>
                                ëŒ“ê¸€ ìƒì„±: referenceì— ê²Œì‹œë¬¼ ID, table=<code
                                    >comments</code
                                >
                            </li>
                            <li>ì¹´í…Œê³ ë¦¬ë³„ ì¡°íšŒ: indexë¡œ ê²€ìƒ‰</li>
                            <li>íƒœê·¸ë¡œ ê´€ë ¨ í¬ìŠ¤íŠ¸ ì°¾ê¸°</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ì´ì»¤ë¨¸ìŠ¤ ìƒí’ˆ ê´€ë¦¬</strong>
                        <ul>
                            <li>
                                ìƒí’ˆ ìƒì„±: table=<code>products</code>,
                                index=<code>price</code>
                            </li>
                            <li>
                                ê°€ê²© ë²”ìœ„ ê²€ìƒ‰: condition <code>>=</code>,
                                <code><=</code> ì‚¬ìš©
                            </li>
                            <li>ìƒí’ˆ ì´ë¯¸ì§€: Files íƒ­ì—ì„œ ì—…ë¡œë“œ</li>
                            <li>ë¦¬ë·°: referenceë¡œ ìƒí’ˆì— ì—°ê²°</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ì†Œì…œ ë¯¸ë””ì–´ ê¸°ëŠ¥</strong>
                        <ul>
                            <li>
                                ê²Œì‹œë¬¼: table=<code>feed</code>, upload_to_feed
                                ì²´í¬
                            </li>
                            <li>ë‹¤ë¥¸ ì‚¬ìš©ì êµ¬ë…</li>
                            <li>í”¼ë“œ ì¡°íšŒë¡œ êµ¬ë…í•œ ì‚¬ëŒë“¤ ê²Œì‹œë¬¼ í™•ì¸</li>
                            <li>ì°¨ë‹¨ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</li>
                        </ul>
                    </li>
                </ol>
            </details>
        </div>

        <div class="container">
            <!-- Left Panel: Database Operations -->
            <div class="panel">
                <h2>ğŸ“ Database Operations</h2>

                <div class="tabs">
                    <button class="tab active" onclick="switchTab('create')">
                        Create
                    </button>
                    <button class="tab" onclick="switchTab('read')">
                        Read
                    </button>
                    <button class="tab" onclick="switchTab('update')">
                        Update
                    </button>
                    <button class="tab" onclick="switchTab('delete')">
                        Delete
                    </button>
                    <button class="tab" onclick="switchTab('file')">
                        Files
                    </button>
                </div>

                <!-- CREATE TAB -->
                <div id="tab-create" class="tab-content active">
                    <h3>ğŸ“„ Create Record</h3>

                    <div class="form-group">
                        <label>Data (JSON):</label>
                        <textarea
                            id="createData"
                            placeholder='{"key": "value"}'
                        ></textarea>
                    </div>

                    <div class="form-group">
                        <label>Table Name:</label>
                        <input
                            type="text"
                            id="createTableName"
                            placeholder="my_table"
                        />
                    </div>

                    <div class="inline-group">
                        <div class="form-group">
                            <label>Access Group:</label>
                            <select id="createAccessGroup">
                                <option value="public">Public</option>
                                <option value="authorized">Authorized</option>
                                <option value="private">Private</option>
                                <option value="0">0</option>
                                <option value="1">1</option>
                                <option value="99">Admin (99)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Unique ID (optional):</label>
                            <input
                                type="text"
                                id="createUniqueId"
                                placeholder="my_unique_id"
                            />
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Index Name (optional):</label>
                        <input
                            type="text"
                            id="createIndexName"
                            placeholder="year"
                        />
                    </div>

                    <div class="form-group">
                        <label>Index Value (optional):</label>
                        <input
                            type="text"
                            id="createIndexValue"
                            placeholder="2024"
                        />
                    </div>

                    <div class="form-group">
                        <label>Tags (comma separated, optional):</label>
                        <input
                            type="text"
                            id="createTags"
                            placeholder="tag1, tag2"
                        />
                    </div>

                    <div class="form-group">
                        <label>Reference Record ID (optional):</label>
                        <input
                            type="text"
                            id="createReference"
                            placeholder="record_id_to_reference"
                        />
                    </div>

                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="createReadonly" />
                            Readonly (ë ˆì½”ë“œ ìˆ˜ì • ë¶ˆê°€)
                        </label>
                    </div>

                    <h3
                        style="
                            margin-top: 20px;
                            border-top: 1px solid #ddd;
                            padding-top: 15px;
                        "
                    >
                        ğŸ“¢ Subscription Options (êµ¬ë… ì„¤ì •)
                    </h3>

                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="createUploadToFeed" />
                            Upload to Feed (êµ¬ë…ì í”¼ë“œì— í‘œì‹œ)
                        </label>
                    </div>

                    <div class="form-group">
                        <label>
                            <input
                                type="checkbox"
                                id="createNotifySubscribers"
                            />
                            Notify Subscribers (êµ¬ë…ìì—ê²Œ ì•Œë¦¼ ì „ì†¡)
                        </label>
                    </div>

                    <div class="form-group">
                        <label>
                            <input
                                type="checkbox"
                                id="createFeedReferencingRecords"
                            />
                            Feed Referencing Records (ì°¸ì¡° ë ˆì½”ë“œë¥¼ êµ¬ë…ì
                            í”¼ë“œì— í¬í•¨)
                        </label>
                    </div>

                    <div class="form-group">
                        <label>
                            <input
                                type="checkbox"
                                id="createNotifyReferencingRecords"
                            />
                            Notify Referencing Records (ì°¸ì¡° ë ˆì½”ë“œë¥¼ êµ¬ë…ìì—ê²Œ
                            ì•Œë¦¼)
                        </label>
                    </div>

                    <h3
                        style="
                            margin-top: 20px;
                            border-top: 1px solid #ddd;
                            padding-top: 15px;
                        "
                    >
                        ğŸ”— Source Options (ì°¸ì¡° ì œì•½ ì„¤ì •)
                    </h3>

                    <div class="form-group">
                        <label>Referencing Limit (0 = infinite):</label>
                        <input
                            type="number"
                            id="createSourceRefLimit"
                            placeholder="0"
                            min="0"
                        />
                    </div>

                    <div class="form-group">
                        <label>
                            <input
                                type="checkbox"
                                id="createSourcePreventMultiple"
                            />
                            Prevent Multiple Referencing (í•œ ì‚¬ìš©ìê°€ ì´
                            ë ˆì½”ë“œë¥¼ í•œ ë²ˆë§Œ ì°¸ì¡° ê°€ëŠ¥)
                        </label>
                    </div>

                    <div class="form-group">
                        <label>
                            <input
                                type="checkbox"
                                id="createSourceOnlyGranted"
                            />
                            Only Granted Can Reference (ê¶Œí•œ ë¶€ì—¬ë°›ì€ ì‚¬ìš©ìë§Œ
                            ì°¸ì¡° ê°€ëŠ¥)
                        </label>
                    </div>

                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="createSourceCanRemove" />
                            Can Remove Referencing Records (ì†Œìœ ìê°€ ì°¸ì¡° ë ˆì½”ë“œ
                            ì‚­ì œ ê°€ëŠ¥ / ì´ ë ˆì½”ë“œ ì‚­ì œ ì‹œ ì°¸ì¡° ë ˆì½”ë“œë„ ì‚­ì œ)
                        </label>
                    </div>

                    <div class="form-group">
                        <label>
                            <input
                                type="checkbox"
                                id="createSourceAllowGrantOthers"
                            />
                            Allow Granted to Grant Others (ê¶Œí•œ ë°›ì€ ì‚¬ìš©ìê°€
                            ë‹¤ë¥¸ ì‚¬ìš©ìì—ê²Œ ê¶Œí•œ ë¶€ì—¬ ê°€ëŠ¥)
                        </label>
                    </div>

                    <div class="form-group">
                        <label
                            >Referencing Index Restrictions (JSON Array,
                            optional):</label
                        >
                        <textarea
                            id="createSourceIndexRestrictions"
                            placeholder='[{"name": "status", "value": "active", "condition": "="}]'
                            style="min-height: 80px"
                        ></textarea>
                        <small
                            style="color: #666; display: block; margin-top: 5px"
                        >
                            ì˜ˆ: [{"name": "category", "value": "premium"},
                            {"name": "year", "value": 2024, "condition": ">="}]
                        </small>
                    </div>

                    <button onclick="createRecord()" class="success">
                        Create Record
                    </button>
                </div>

                <!-- READ TAB -->
                <div id="tab-read" class="tab-content">
                    <h3>ğŸ“– Read Records</h3>

                    <div class="form-group">
                        <label>Record ID (optional):</label>
                        <input
                            type="text"
                            id="readRecordId"
                            placeholder="record_id_to_fetch"
                        />
                    </div>

                    <div class="form-group">
                        <label>Unique ID (optional):</label>
                        <input
                            type="text"
                            id="readUniqueId"
                            placeholder="unique_id_to_fetch"
                        />
                    </div>

                    <div class="form-group">
                        <label>Table Name:</label>
                        <input
                            type="text"
                            id="readTableName"
                            placeholder="my_table"
                        />
                    </div>

                    <div class="form-group">
                        <label>Access Group:</label>
                        <select id="readAccessGroup">
                            <option value="public">Public</option>
                            <option value="authorized">Authorized</option>
                            <option value="private">Private</option>
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="99">Admin (99)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Index Name (optional):</label>
                        <input
                            type="text"
                            id="readIndexName"
                            placeholder="year"
                        />
                    </div>

                    <div class="inline-group">
                        <div class="form-group">
                            <label>Index Value (optional):</label>
                            <input
                                type="text"
                                id="readIndexValue"
                                placeholder="2024"
                            />
                        </div>

                        <div class="form-group">
                            <label>Condition:</label>
                            <select id="readIndexCondition">
                                <option value="=">=</option>
                                <option value=">">></option>
                                <option value=">=">>=</option>
                                <option value="<"><</option>
                                <option value="<="><=</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Tag (optional):</label>
                        <input
                            type="text"
                            id="readTag"
                            placeholder="tag_to_search"
                        />
                    </div>

                    <div class="form-group">
                        <label>Reference (optional):</label>
                        <input
                            type="text"
                            id="readReference"
                            placeholder="record_id or user_id"
                        />
                    </div>

                    <div class="inline-group">
                        <div class="form-group">
                            <label>Limit:</label>
                            <input
                                type="number"
                                id="readLimit"
                                value="50"
                                min="1"
                                max="1000"
                            />
                        </div>

                        <div class="form-group">
                            <label>
                                <input
                                    type="checkbox"
                                    id="readAscending"
                                    checked
                                />
                                Ascending
                            </label>
                            <label>
                                <input type="checkbox" id="readFetchMore" />
                                Fetch More
                            </label>
                        </div>
                    </div>

                    <button onclick="getRecords()">Get Records</button>
                </div>

                <!-- UPDATE TAB -->
                <div id="tab-update" class="tab-content">
                    <h3>âœï¸ Update Record</h3>

                    <div
                        style="
                            background-color: #d1ecf1;
                            padding: 10px;
                            border-radius: 4px;
                            margin-bottom: 15px;
                            font-size: 13px;
                            border: 1px solid #17a2b8;
                        "
                    >
                        ğŸ’¡ <strong>Tip:</strong> Record IDë¥¼ ì…ë ¥í•˜ê³  "Load
                        Record" ë²„íŠ¼ì„ ë¨¼ì € í´ë¦­í•˜ì„¸ìš”. í˜„ì¬ ë ˆì½”ë“œ ìƒíƒœê°€
                        ìë™ìœ¼ë¡œ ë¶ˆëŸ¬ì™€ì§‘ë‹ˆë‹¤.
                    </div>

                    <div class="form-group">
                        <label>Record ID (required):</label>
                        <input
                            type="text"
                            id="updateRecordId"
                            placeholder="record_id_to_update"
                        />
                    </div>

                    <button
                        onclick="loadRecordForUpdate()"
                        style="background-color: #17a2b8; margin-bottom: 15px"
                    >
                        ğŸ“¥ Load Record
                    </button>

                    <div
                        id="updateRecordInfo"
                        style="
                            display: none;
                            background-color: #d4edda;
                            border: 1px solid #28a745;
                            border-radius: 4px;
                            padding: 10px;
                            margin-bottom: 15px;
                        "
                    >
                        <strong>âœ… Record Loaded</strong>
                        <div
                            id="updateRecordInfoContent"
                            style="margin-top: 5px; font-size: 12px"
                        ></div>
                    </div>

                    <div class="form-group">
                        <label>Data (JSON):</label>
                        <textarea
                            id="updateData"
                            placeholder='{"key": "value"}'
                        ></textarea>
                    </div>

                    <div class="form-group">
                        <label>Table Name:</label>
                        <input
                            type="text"
                            id="updateTableName"
                            placeholder="table_name"
                        />
                    </div>

                    <div class="form-group">
                        <label>Access Group:</label>
                        <select id="updateAccessGroup">
                            <option value="">Select access group</option>
                            <option value="public">Public</option>
                            <option value="authorized">Authorized</option>
                            <option value="private">Private</option>
                        </select>
                    </div>

                    <h3
                        style="
                            margin-top: 20px;
                            border-top: 1px solid #ddd;
                            padding-top: 15px;
                        "
                    >
                        ğŸ“¢ Subscription Options
                    </h3>

                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="updateUploadToFeed" />
                            Upload to Feed
                        </label>
                    </div>

                    <div class="form-group">
                        <label>
                            <input
                                type="checkbox"
                                id="updateNotifySubscribers"
                            />
                            Notify Subscribers
                        </label>
                    </div>

                    <div class="form-group">
                        <label>
                            <input
                                type="checkbox"
                                id="updateFeedReferencingRecords"
                            />
                            Feed Referencing Records
                        </label>
                    </div>

                    <div class="form-group">
                        <label>
                            <input
                                type="checkbox"
                                id="updateNotifyReferencingRecords"
                            />
                            Notify Referencing Records
                        </label>
                    </div>

                    <h3
                        style="
                            margin-top: 20px;
                            border-top: 1px solid #ddd;
                            padding-top: 15px;
                        "
                    >
                        ğŸ”— Source Options (ì°¸ì¡° ì œì•½)
                    </h3>

                    <div class="form-group">
                        <label>Referencing Limit (0 = infinite):</label>
                        <input
                            type="number"
                            id="updateSourceRefLimit"
                            placeholder="0"
                            min="0"
                        />
                    </div>

                    <div class="form-group">
                        <label>
                            <input
                                type="checkbox"
                                id="updateSourcePreventMultiple"
                            />
                            Prevent Multiple Referencing
                        </label>
                    </div>

                    <div class="form-group">
                        <label>
                            <input
                                type="checkbox"
                                id="updateSourceOnlyGranted"
                            />
                            Only Granted Can Reference
                        </label>
                    </div>

                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="updateSourceCanRemove" />
                            Can Remove Referencing Records
                        </label>
                    </div>

                    <div class="form-group">
                        <label>
                            <input
                                type="checkbox"
                                id="updateSourceAllowGrantOthers"
                            />
                            Allow Granted to Grant Others
                        </label>
                    </div>

                    <div class="form-group">
                        <label
                            >Referencing Index Restrictions (JSON Array):</label
                        >
                        <textarea
                            id="updateSourceIndexRestrictions"
                            placeholder='[{"name": "status", "value": "active", "condition": "="}]'
                            style="min-height: 80px"
                        ></textarea>
                    </div>

                    <button onclick="updateRecord()">Update Record</button>
                </div>

                <!-- DELETE TAB -->
                <div id="tab-delete" class="tab-content">
                    <h3>ğŸ—‘ï¸ Delete Records</h3>

                    <div class="form-group">
                        <label>Record IDs (comma separated):</label>
                        <input
                            type="text"
                            id="deleteRecordIds"
                            placeholder="record_id_1, record_id_2"
                        />
                    </div>

                    <div class="form-group">
                        <label>OR Delete by Query:</label>
                    </div>

                    <div class="form-group">
                        <label>Table Name:</label>
                        <input
                            type="text"
                            id="deleteTableName"
                            placeholder="my_table"
                        />
                    </div>

                    <div class="form-group">
                        <label>Access Group:</label>
                        <select id="deleteAccessGroup">
                            <option value="">All</option>
                            <option value="public">Public</option>
                            <option value="authorized">Authorized</option>
                            <option value="private">Private</option>
                        </select>
                    </div>

                    <button onclick="deleteRecords()" class="danger">
                        Delete Records
                    </button>
                </div>

                <!-- FILE TAB -->
                <div id="tab-file" class="tab-content">
                    <h3>ğŸ“ File Operations</h3>

                    <form id="fileUploadForm" onsubmit="uploadFile(event)">
                        <div class="form-group">
                            <label>Table Name:</label>
                            <input
                                type="text"
                                name="tableName"
                                placeholder="my_files"
                                required
                            />
                        </div>

                        <div class="form-group">
                            <label>Description:</label>
                            <input
                                type="text"
                                name="description"
                                placeholder="File description"
                            />
                        </div>

                        <div class="form-group">
                            <label>Files:</label>
                            <input type="file" name="files" multiple />
                        </div>

                        <div id="uploadProgress" style="display: none">
                            <div
                                style="
                                    background: #e9ecef;
                                    border-radius: 4px;
                                    overflow: hidden;
                                    margin: 10px 0;
                                "
                            >
                                <div
                                    id="progressBar"
                                    style="
                                        background: #007bff;
                                        height: 20px;
                                        width: 0%;
                                        transition: width 0.3s;
                                    "
                                ></div>
                            </div>
                            <div
                                id="progressText"
                                style="text-align: center; font-size: 12px"
                            ></div>
                        </div>

                        <button type="submit">Upload Files</button>
                    </form>

                    <hr />

                    <div class="form-group">
                        <label>Download File by Record ID:</label>
                        <input
                            type="text"
                            id="downloadRecordId"
                            placeholder="record_id_with_files"
                        />
                    </div>
                    <button onclick="downloadFile()">Get Files</button>
                </div>
            </div>

            <!-- Right Panel: Advanced Features -->
            <div class="panel">
                <h2>ğŸš€ Advanced Features</h2>

                <div class="tabs">
                    <button
                        class="tab active"
                        onclick="switchAdvancedTab('subscription')"
                    >
                        Subscription
                    </button>
                    <button class="tab" onclick="switchAdvancedTab('access')">
                        Access
                    </button>
                    <button class="tab" onclick="switchAdvancedTab('info')">
                        Info
                    </button>
                </div>

                <!-- SUBSCRIPTION TAB -->
                <div id="adv-tab-subscription" class="tab-content active">
                    <h3>ğŸ“° Subscription</h3>

                    <div class="form-group">
                        <label>User ID to Subscribe:</label>
                        <input
                            type="text"
                            id="subscribeUserId"
                            placeholder="user_id_to_subscribe"
                        />
                    </div>
                    <button onclick="subscribe()">Subscribe</button>
                    <button onclick="unsubscribe()" class="danger">
                        Unsubscribe
                    </button>

                    <hr />

                    <div class="form-group">
                        <label>Block User ID:</label>
                        <input
                            type="text"
                            id="blockUserId"
                            placeholder="user_id_to_block"
                        />
                    </div>
                    <button onclick="blockSubscriber()" class="danger">
                        Block Subscriber
                    </button>
                    <button onclick="unblockSubscriber()">
                        Unblock Subscriber
                    </button>

                    <hr />

                    <h3 style="margin-top: 20px">ğŸ“° Feed</h3>

                    <div class="form-group">
                        <label>Access Group:</label>
                        <select id="feedAccessGroup">
                            <option value="">No Setting</option>
                            <option value="0">0 - Public</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                            <option value="99">99</option>
                        </select>
                    </div>

                    <div class="inline-group">
                        <div class="form-group">
                            <label>Limit:</label>
                            <input
                                type="number"
                                id="feedLimit"
                                value="50"
                                min="1"
                                max="1000"
                            />
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="feedFetchMore" />
                                Fetch More
                            </label>
                        </div>
                    </div>

                    <button onclick="getSubscriptions()">
                        Get My Subscriptions
                    </button>
                    <button onclick="getFeed()">Get My Feed</button>

                    <hr />
                    <h4 style="color: #dc3545; margin-top: 15px">
                        ğŸ” Debug Tools
                    </h4>
                    <button
                        onclick="debugSubscription()"
                        style="background-color: #ffc107; color: #000"
                    >
                        Debug: Check Subscription Status
                    </button>
                    <button
                        onclick="debugFeedRecords()"
                        style="background-color: #17a2b8"
                    >
                        Debug: Check Feed Records
                    </button>
                </div>

                <!-- ACCESS TAB -->
                <div id="adv-tab-access" class="tab-content">
                    <h3>ğŸ” Private Access</h3>

                    <div class="form-group">
                        <label>Record ID:</label>
                        <input
                            type="text"
                            id="accessRecordId"
                            placeholder="record_id"
                        />
                    </div>

                    <div class="form-group">
                        <label>User ID to Grant/Remove:</label>
                        <input
                            type="text"
                            id="accessUserId"
                            placeholder="user_id"
                        />
                    </div>

                    <button onclick="grantPrivateAccess()" class="success">
                        Grant Private Access
                    </button>
                    <button onclick="removePrivateAccess()" class="danger">
                        Remove Private Access
                    </button>

                    <hr />

                    <button onclick="listPrivateAccess()">
                        List Private Access Grants
                    </button>
                </div>

                <!-- INFO TAB -->
                <div id="adv-tab-info" class="tab-content">
                    <h3>ğŸ“Š Database Information</h3>

                    <button onclick="getTables()">Get All Tables</button>
                    <button onclick="getIndexes()">Get Indexes</button>
                    <button onclick="getTags()">Get Tags</button>

                    <hr />

                    <div class="form-group">
                        <label>Get Unique IDs starting with:</label>
                        <input
                            type="text"
                            id="uniqueIdPrefix"
                            placeholder="prefix_"
                        />
                    </div>
                    <button onclick="getUniqueIds()">Get Unique IDs</button>

                    <hr />

                    <div class="form-group">
                        <label>Table Name for Index Info:</label>
                        <input
                            type="text"
                            id="indexTableName"
                            placeholder="my_table"
                        />
                    </div>
                    <div class="form-group">
                        <label>Index Name:</label>
                        <input type="text" id="indexName" placeholder="year" />
                    </div>
                    <button onclick="getIndexInfo()">Get Index Info</button>
                </div>
            </div>
        </div>

        <!-- Result Log Panel (Full Width) -->
        <div class="panel" style="margin-top: 20px">
            <h2>ğŸ“‹ Result Log</h2>
            <button onclick="clearLog()">Clear Log</button>
            <div id="resultLog"></div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/skapi-js@latest/dist/skapi.js"></script>
        <script src="../service.js"></script>
        <script>
            // Tab switching
            function switchTab(tab) {
                document.querySelectorAll("#tab-" + tab).forEach((el) => {
                    document
                        .querySelectorAll(".tab-content")
                        .forEach((tc) => tc.classList.remove("active"));
                    document
                        .querySelectorAll(".tab")
                        .forEach((t) => t.classList.remove("active"));
                    el.classList.add("active");
                    event.target.classList.add("active");
                });
            }

            function switchAdvancedTab(tab) {
                document.querySelectorAll("#adv-tab-" + tab).forEach((el) => {
                    document
                        .querySelectorAll(
                            "#adv-tab-subscription, #adv-tab-access, #adv-tab-info"
                        )
                        .forEach((tc) => tc.classList.remove("active"));
                    document
                        .querySelectorAll(".panel:nth-child(2) .tab")
                        .forEach((t) => t.classList.remove("active"));
                    el.classList.add("active");
                    event.target.classList.add("active");
                });
            }

            // Log functions
            function addLog(type, title, data) {
                const log = document.getElementById("resultLog");
                const item = document.createElement("div");
                item.className = `result-item ${type}`;

                const time = new Date().toLocaleTimeString("ko-KR");
                item.innerHTML = `
                <div style="font-weight: bold; margin-bottom: 5px;">${title}</div>
                <pre style="margin: 0; white-space: pre-wrap; word-wrap: break-word;">${JSON.stringify(
                    data,
                    null,
                    2
                )}</pre>
                <div style="font-size: 10px; color: #666; margin-top: 5px;">${time}</div>
            `;

                log.insertBefore(item, log.firstChild);
            }

            function clearLog() {
                document.getElementById("resultLog").innerHTML = "";
            }

            // ==================== CREATE ====================
            async function createRecord() {
                try {
                    const dataStr = document
                        .getElementById("createData")
                        .value.trim();
                    const data = dataStr ? JSON.parse(dataStr) : null;

                    const config = {
                        table: {
                            name:
                                document.getElementById("createTableName")
                                    .value || "test_table",
                            access_group:
                                document.getElementById("createAccessGroup")
                                    .value,
                        },
                    };

                    const uniqueId = document
                        .getElementById("createUniqueId")
                        .value.trim();
                    if (uniqueId) config.unique_id = uniqueId;

                    const indexName = document
                        .getElementById("createIndexName")
                        .value.trim();
                    const indexValue = document
                        .getElementById("createIndexValue")
                        .value.trim();
                    if (indexName && indexValue) {
                        config.index = {
                            name: indexName,
                            value: isNaN(indexValue)
                                ? indexValue
                                : Number(indexValue),
                        };
                    }

                    const tags = document
                        .getElementById("createTags")
                        .value.trim();
                    if (tags)
                        config.tags = tags.split(",").map((t) => t.trim());

                    const reference = document
                        .getElementById("createReference")
                        .value.trim();
                    if (reference) config.reference = reference;

                    if (document.getElementById("createReadonly").checked)
                        config.readonly = true;

                    // Subscription options
                    const uploadFeedChecked =
                        document.getElementById("createUploadToFeed").checked;
                    const notifySubChecked = document.getElementById(
                        "createNotifySubscribers"
                    ).checked;
                    const feedRefChecked = document.getElementById(
                        "createFeedReferencingRecords"
                    ).checked;
                    const notifyRefChecked = document.getElementById(
                        "createNotifyReferencingRecords"
                    ).checked;

                    if (
                        uploadFeedChecked ||
                        notifySubChecked ||
                        feedRefChecked ||
                        notifyRefChecked
                    ) {
                        config.table.subscription = {};

                        if (uploadFeedChecked) {
                            config.table.subscription.upload_to_feed = true;
                        }
                        if (notifySubChecked) {
                            config.table.subscription.notify_subscribers = true;
                        }
                        if (feedRefChecked) {
                            config.table.subscription.feed_referencing_records = true;
                        }
                        if (notifyRefChecked) {
                            config.table.subscription.notify_referencing_records = true;
                        }
                    }

                    // Source options
                    const sourceOptions = {};

                    const refLimit = document
                        .getElementById("createSourceRefLimit")
                        .value.trim();
                    if (refLimit !== "") {
                        const limitNum = Number(refLimit);
                        sourceOptions.referencing_limit =
                            limitNum === 0 ? null : limitNum;
                    }

                    if (
                        document.getElementById("createSourcePreventMultiple")
                            .checked
                    ) {
                        sourceOptions.prevent_multiple_referencing = true;
                    }

                    if (
                        document.getElementById("createSourceOnlyGranted")
                            .checked
                    ) {
                        sourceOptions.only_granted_can_reference = true;
                    }

                    if (
                        document.getElementById("createSourceCanRemove").checked
                    ) {
                        sourceOptions.can_remove_referencing_records = true;
                    }

                    if (
                        document.getElementById("createSourceAllowGrantOthers")
                            .checked
                    ) {
                        sourceOptions.allow_granted_to_grant_others = true;
                    }

                    const indexRestrictions = document
                        .getElementById("createSourceIndexRestrictions")
                        .value.trim();
                    if (indexRestrictions) {
                        try {
                            sourceOptions.referencing_index_restrictions =
                                JSON.parse(indexRestrictions);
                        } catch (e) {
                            alert(
                                "Invalid JSON format for referencing_index_restrictions"
                            );
                            return;
                        }
                    }

                    // Only add source if at least one option is set
                    if (Object.keys(sourceOptions).length > 0) {
                        config.source = sourceOptions;
                    }

                    const result = await skapi.postRecord(data, config);
                    addLog("success", "âœ… Record Created", result);
                } catch (error) {
                    addLog("error", "âŒ Create Failed", error.message);
                }
            }

            // ==================== READ ====================
            async function getRecords() {
                try {
                    const query = {};

                    const recordId = document
                        .getElementById("readRecordId")
                        .value.trim();
                    if (recordId) {
                        query.record_id = recordId;
                    } else {
                        const uniqueId = document
                            .getElementById("readUniqueId")
                            .value.trim();
                        if (uniqueId) {
                            query.unique_id = uniqueId;
                        } else {
                            query.table = {
                                name:
                                    document.getElementById("readTableName")
                                        .value || "test_table",
                                access_group:
                                    document.getElementById("readAccessGroup")
                                        .value,
                            };

                            const indexName = document
                                .getElementById("readIndexName")
                                .value.trim();
                            const indexValue = document
                                .getElementById("readIndexValue")
                                .value.trim();
                            if (indexName && indexValue) {
                                query.index = {
                                    name: indexName,
                                    value: isNaN(indexValue)
                                        ? indexValue
                                        : Number(indexValue),
                                    condition:
                                        document.getElementById(
                                            "readIndexCondition"
                                        ).value,
                                };
                            }

                            const tag = document
                                .getElementById("readTag")
                                .value.trim();
                            if (tag) query.tag = tag;

                            const reference = document
                                .getElementById("readReference")
                                .value.trim();
                            if (reference) query.reference = reference;
                        }
                    }

                    const fetchOptions = {
                        limit: Number(
                            document.getElementById("readLimit").value
                        ),
                        ascending:
                            document.getElementById("readAscending").checked,
                        fetchMore:
                            document.getElementById("readFetchMore").checked,
                    };

                    const result = await skapi.getRecords(query, fetchOptions);
                    addLog("success", "ğŸ“– Records Retrieved", {
                        count: result.list.length,
                        endOfList: result.endOfList,
                        records: result.list,
                    });
                } catch (error) {
                    addLog("error", "âŒ Read Failed", error.message);
                }
            }

            // ==================== UPDATE ====================
            async function loadRecordForUpdate() {
                try {
                    const recordId = document
                        .getElementById("updateRecordId")
                        .value.trim();
                    if (!recordId) {
                        alert("Record ID is required");
                        return;
                    }

                    addLog(
                        "info",
                        "ğŸ“¥ Loading Record",
                        "Fetching record data..."
                    );

                    const result = await skapi.getRecords({
                        record_id: recordId,
                    });

                    if (!result.list || result.list.length === 0) {
                        alert("Record not found");
                        return;
                    }

                    const record = result.list[0];

                    // Fill in the data
                    document.getElementById("updateData").value =
                        JSON.stringify(record.data, null, 2);

                    // Fill in table info
                    if (record.table) {
                        document.getElementById("updateTableName").value =
                            record.table.name || "";
                        document.getElementById("updateAccessGroup").value =
                            record.table.access_group || "";

                        // Fill subscription options
                        if (record.table.subscription) {
                            document.getElementById(
                                "updateUploadToFeed"
                            ).checked =
                                record.table.subscription.upload_to_feed ||
                                false;
                            document.getElementById(
                                "updateNotifySubscribers"
                            ).checked =
                                record.table.subscription.notify_subscribers ||
                                false;
                            document.getElementById(
                                "updateFeedReferencingRecords"
                            ).checked =
                                record.table.subscription
                                    .feed_referencing_records || false;
                            document.getElementById(
                                "updateNotifyReferencingRecords"
                            ).checked =
                                record.table.subscription
                                    .notify_referencing_records || false;
                        } else {
                            document.getElementById(
                                "updateUploadToFeed"
                            ).checked = false;
                            document.getElementById(
                                "updateNotifySubscribers"
                            ).checked = false;
                            document.getElementById(
                                "updateFeedReferencingRecords"
                            ).checked = false;
                            document.getElementById(
                                "updateNotifyReferencingRecords"
                            ).checked = false;
                        }
                    }

                    // Fill source options
                    if (record.source) {
                        const refLimit = record.source.referencing_limit;
                        document.getElementById("updateSourceRefLimit").value =
                            refLimit === null ? "0" : refLimit;
                        document.getElementById(
                            "updateSourcePreventMultiple"
                        ).checked =
                            record.source.prevent_multiple_referencing || false;
                        document.getElementById(
                            "updateSourceOnlyGranted"
                        ).checked =
                            record.source.only_granted_can_reference || false;
                        document.getElementById(
                            "updateSourceCanRemove"
                        ).checked =
                            record.source.can_remove_referencing_records ||
                            false;
                        document.getElementById(
                            "updateSourceAllowGrantOthers"
                        ).checked =
                            record.source.allow_granted_to_grant_others ||
                            false;

                        if (record.source.referencing_index_restrictions) {
                            document.getElementById(
                                "updateSourceIndexRestrictions"
                            ).value = JSON.stringify(
                                record.source.referencing_index_restrictions,
                                null,
                                2
                            );
                        } else {
                            document.getElementById(
                                "updateSourceIndexRestrictions"
                            ).value = "";
                        }
                    } else {
                        document.getElementById("updateSourceRefLimit").value =
                            "";
                        document.getElementById(
                            "updateSourcePreventMultiple"
                        ).checked = false;
                        document.getElementById(
                            "updateSourceOnlyGranted"
                        ).checked = false;
                        document.getElementById(
                            "updateSourceCanRemove"
                        ).checked = false;
                        document.getElementById(
                            "updateSourceAllowGrantOthers"
                        ).checked = false;
                        document.getElementById(
                            "updateSourceIndexRestrictions"
                        ).value = "";
                    }

                    // Show loaded info
                    const infoDiv = document.getElementById("updateRecordInfo");
                    const infoContent = document.getElementById(
                        "updateRecordInfoContent"
                    );
                    infoContent.innerHTML = `
                        <strong>Table:</strong> ${record.table.name} (${
                        record.table.access_group
                    })<br>
                        <strong>Uploaded:</strong> ${new Date(
                            record.uploaded
                        ).toLocaleString("ko-KR")}<br>
                        <strong>Updated:</strong> ${new Date(
                            record.updated
                        ).toLocaleString("ko-KR")}
                    `;
                    infoDiv.style.display = "block";

                    addLog("success", "âœ… Record Loaded Successfully", {
                        record_id: record.record_id,
                        table: record.table.name,
                        data: record.data,
                    });
                } catch (error) {
                    addLog("error", "âŒ Load Record Failed", error.message);
                }
            }

            async function updateRecord() {
                try {
                    const recordId = document
                        .getElementById("updateRecordId")
                        .value.trim();
                    if (!recordId) {
                        alert("Record ID is required");
                        return;
                    }

                    const dataStr = document
                        .getElementById("updateData")
                        .value.trim();

                    if (!dataStr) {
                        alert(
                            'New Data is required. Cannot update with empty data.\n\nTip: Enter the data you want to update, e.g., {"name": "updated"}'
                        );
                        return;
                    }

                    const data = JSON.parse(dataStr);

                    const config = { record_id: recordId };

                    const tableName = document
                        .getElementById("updateTableName")
                        .value.trim();
                    const accessGroup =
                        document.getElementById("updateAccessGroup").value;

                    // Check if any subscription options are set
                    const uploadFeedChecked =
                        document.getElementById("updateUploadToFeed").checked;
                    const notifySubChecked = document.getElementById(
                        "updateNotifySubscribers"
                    ).checked;
                    const feedRefChecked = document.getElementById(
                        "updateFeedReferencingRecords"
                    ).checked;
                    const notifyRefChecked = document.getElementById(
                        "updateNotifyReferencingRecords"
                    ).checked;

                    // Always create table config if we have table name or access group or subscription options
                    if (tableName || accessGroup) {
                        config.table = {};
                        if (tableName) config.table.name = tableName;
                        if (accessGroup)
                            config.table.access_group = accessGroup;
                    }

                    // Add subscription options - include all values (true or false) when updating
                    // This ensures unchecked boxes are also updated as false
                    if (
                        config.table ||
                        uploadFeedChecked ||
                        notifySubChecked ||
                        feedRefChecked ||
                        notifyRefChecked
                    ) {
                        if (!config.table) config.table = {};

                        config.table.subscription = {
                            upload_to_feed: uploadFeedChecked,
                            notify_subscribers: notifySubChecked,
                            feed_referencing_records: feedRefChecked,
                            notify_referencing_records: notifyRefChecked,
                        };
                    }

                    // Source options for update
                    const sourceOptions = {};
                    let hasSourceUpdate = false;

                    const refLimit = document
                        .getElementById("updateSourceRefLimit")
                        .value.trim();
                    if (refLimit !== "") {
                        const limitNum = Number(refLimit);
                        sourceOptions.referencing_limit =
                            limitNum === 0 ? null : limitNum;
                        hasSourceUpdate = true;
                    }

                    if (
                        document.getElementById("updateSourcePreventMultiple")
                            .checked
                    ) {
                        sourceOptions.prevent_multiple_referencing = true;
                        hasSourceUpdate = true;
                    }

                    if (
                        document.getElementById("updateSourceOnlyGranted")
                            .checked
                    ) {
                        sourceOptions.only_granted_can_reference = true;
                        hasSourceUpdate = true;
                    }

                    if (
                        document.getElementById("updateSourceCanRemove").checked
                    ) {
                        sourceOptions.can_remove_referencing_records = true;
                        hasSourceUpdate = true;
                    }

                    if (
                        document.getElementById("updateSourceAllowGrantOthers")
                            .checked
                    ) {
                        sourceOptions.allow_granted_to_grant_others = true;
                        hasSourceUpdate = true;
                    }

                    const indexRestrictions = document
                        .getElementById("updateSourceIndexRestrictions")
                        .value.trim();
                    if (indexRestrictions) {
                        try {
                            sourceOptions.referencing_index_restrictions =
                                JSON.parse(indexRestrictions);
                            hasSourceUpdate = true;
                        } catch (e) {
                            alert(
                                "Invalid JSON format for referencing_index_restrictions"
                            );
                            return;
                        }
                    }

                    // Only add source if at least one option is set
                    if (hasSourceUpdate) {
                        config.source = sourceOptions;
                    }

                    const result = await skapi.postRecord(data, config);
                    addLog("success", "âœï¸ Record Updated", result);
                } catch (error) {
                    addLog("error", "âŒ Update Failed", error.message);
                }
            }

            // ==================== DELETE ====================
            async function deleteRecords() {
                try {
                    const recordIds = document
                        .getElementById("deleteRecordIds")
                        .value.trim();

                    let query;
                    if (recordIds) {
                        query = {
                            record_id: recordIds
                                .split(",")
                                .map((id) => id.trim()),
                        };
                    } else {
                        const tableName = document
                            .getElementById("deleteTableName")
                            .value.trim();
                        const accessGroup =
                            document.getElementById("deleteAccessGroup").value;

                        if (!tableName) {
                            alert("Please provide record IDs or table name");
                            return;
                        }

                        query = {
                            table: { name: tableName },
                        };
                        if (accessGroup) query.table.access_group = accessGroup;
                    }

                    const result = await skapi.deleteRecords(query);
                    addLog("success", "ğŸ—‘ï¸ Records Deleted", result);
                } catch (error) {
                    addLog("error", "âŒ Delete Failed", error.message);
                }
            }

            // ==================== FILE ====================
            async function uploadFile(event) {
                event.preventDefault();

                try {
                    const form = event.target;
                    const tableName = form.tableName.value;

                    const progressDiv =
                        document.getElementById("uploadProgress");
                    const progressBar = document.getElementById("progressBar");
                    const progressText =
                        document.getElementById("progressText");

                    progressDiv.style.display = "block";

                    const config = {
                        table: { name: tableName, access_group: "public" },
                        progress: (p) => {
                            if (p.status === "upload") {
                                const percent = Math.round(p.progress);
                                progressBar.style.width = percent + "%";
                                progressText.textContent = `${percent}% - ${
                                    p.currentFile?.name || ""
                                }`;
                            }
                        },
                    };

                    const result = await skapi.postRecord(event, config);

                    progressDiv.style.display = "none";
                    addLog("success", "ğŸ“ Files Uploaded", result);
                    form.reset();
                } catch (error) {
                    document.getElementById("uploadProgress").style.display =
                        "none";
                    addLog("error", "âŒ Upload Failed", error.message);
                }
            }

            async function downloadFile() {
                try {
                    const recordId = document
                        .getElementById("downloadRecordId")
                        .value.trim();
                    if (!recordId) {
                        alert("Record ID is required");
                        return;
                    }

                    const result = await skapi.getRecords({
                        record_id: recordId,
                    });
                    const record = result.list[0];

                    if (!record || !record.bin) {
                        addLog(
                            "info",
                            "ğŸ“ No Files",
                            "No files found in this record"
                        );
                        return;
                    }

                    addLog("info", "ğŸ“ Files Found", record.bin);

                    // Download first file
                    const fileKey = Object.keys(record.bin)[0];
                    const file = record.bin[fileKey][0];

                    if (file) {
                        file.getFile(); // Browser download
                        addLog("success", "ğŸ“¥ Downloading File", file);
                    }
                } catch (error) {
                    addLog("error", "âŒ Download Failed", error.message);
                }
            }

            // ==================== SUBSCRIPTION ====================
            async function subscribe() {
                try {
                    const userId = document
                        .getElementById("subscribeUserId")
                        .value.trim();
                    if (!userId) {
                        alert("User ID is required");
                        return;
                    }

                    const result = await skapi.subscribe({
                        user_id: userId,
                        get_feed: true, // Required to enable getFeed() method
                    });
                    addLog("success", "ğŸ“° Subscribed", result);
                } catch (error) {
                    addLog("error", "âŒ Subscribe Failed", error.message);
                }
            }

            async function unsubscribe() {
                try {
                    const userId = document
                        .getElementById("subscribeUserId")
                        .value.trim();
                    if (!userId) {
                        alert("User ID is required");
                        return;
                    }

                    const result = await skapi.unsubscribe({
                        user_id: userId,
                    });
                    addLog("success", "ğŸ“° Unsubscribed", result);
                } catch (error) {
                    addLog("error", "âŒ Unsubscribe Failed", error.message);
                }
            }

            async function blockSubscriber() {
                try {
                    const userId = document
                        .getElementById("blockUserId")
                        .value.trim();
                    if (!userId) {
                        alert("User ID is required");
                        return;
                    }

                    const result = await skapi.blockSubscriber({
                        user_id: userId,
                    });
                    addLog("success", "ğŸš« Subscriber Blocked", result);
                } catch (error) {
                    addLog("error", "âŒ Block Failed", error.message);
                }
            }

            async function unblockSubscriber() {
                try {
                    const userId = document
                        .getElementById("blockUserId")
                        .value.trim();
                    if (!userId) {
                        alert("User ID is required");
                        return;
                    }

                    const result = await skapi.unblockSubscriber({
                        user_id: userId,
                    });
                    addLog("success", "âœ… Subscriber Unblocked", result);
                } catch (error) {
                    addLog("error", "âŒ Unblock Failed", error.message);
                }
            }

            async function getSubscriptions() {
                try {
                    const result = await skapi.getSubscriptions({
                        subscriber: skapi.user.user_id,
                    });
                    addLog("success", "ğŸ“° My Subscriptions", {
                        count: result.list?.length || 0,
                        subscriptions: result,
                    });
                } catch (error) {
                    addLog(
                        "error",
                        "âŒ Get Subscriptions Failed",
                        error.message
                    );
                }
            }

            async function getFeed() {
                try {
                    // Check if skapi is defined
                    if (typeof skapi === "undefined") {
                        addLog(
                            "error",
                            "âŒ Skapi Not Loaded",
                            "skapi is not defined. Please reload the page."
                        );
                        alert("Skapi is not loaded. Please reload the page.");
                        return;
                    }

                    const accessGroup =
                        document.getElementById("feedAccessGroup").value;

                    // Prepare params object (first parameter)
                    const params = {};
                    if (accessGroup !== "") {
                        params.access_group = Number(accessGroup);
                    }

                    // Prepare fetchOptions (second parameter)
                    const fetchOptions = {
                        limit: Number(
                            document.getElementById("feedLimit").value || 50
                        ),
                        fetchMore:
                            document.getElementById("feedFetchMore").checked,
                    };

                    // Call getFeed with params and fetchOptions
                    const result = await skapi.getFeed(
                        Object.keys(params).length > 0 ? params : undefined,
                        fetchOptions
                    );

                    addLog("success", "ğŸ“° My Feed", {
                        params:
                            Object.keys(params).length > 0
                                ? params
                                : "(no params)",
                        count: result.list.length,
                        endOfList: result.endOfList,
                        feeds: result.list,
                    });
                } catch (error) {
                    addLog("error", "âŒ Get Feed Failed", error.message);
                }
            }

            // ==================== DEBUG FUNCTIONS ====================
            async function debugSubscription() {
                try {
                    addLog(
                        "info",
                        "ğŸ” Debug: Checking Subscription Status",
                        "Starting debug..."
                    );

                    // 1. Check current user
                    const currentUser = skapi.user;
                    addLog("info", "ğŸ‘¤ Current User", {
                        user_id: currentUser.user_id,
                        email: currentUser.email,
                    });

                    // 2. Check subscriptions
                    const subscriptions = await skapi.getSubscriptions({
                        subscriber: currentUser.user_id,
                    });
                    addLog("info", "ğŸ“‹ My Subscriptions", {
                        count: subscriptions.list?.length || 0,
                        list: subscriptions.list || [],
                    });

                    // 3. Check if user is subscribed to anyone
                    if (subscriptions.list && subscriptions.list.length > 0) {
                        addLog(
                            "success",
                            "âœ… You are subscribed to users",
                            subscriptions.list
                        );
                    } else {
                        addLog(
                            "info",
                            "â„¹ï¸ You are not subscribed to anyone",
                            "Subscribe to a user first!"
                        );
                    }
                } catch (error) {
                    addLog("error", "âŒ Debug Failed", error.message);
                }
            }

            async function debugFeedRecords() {
                try {
                    addLog(
                        "info",
                        "ğŸ” Debug: Checking Feed Records",
                        "Searching for subscription records..."
                    );

                    // Check all public subscription records
                    const query = {
                        table: {
                            name: "feed",
                            access_group: "public",
                            subscription: true,
                        },
                    };

                    const result = await skapi.getRecords(query, {
                        limit: 100,
                    });

                    addLog("info", "ğŸ“Š Feed Table Records", {
                        count: result.list.length,
                        records: result.list.map((r) => ({
                            record_id: r.record_id,
                            user_id: r.user_id,
                            uploaded: new Date(r.uploaded).toLocaleString(
                                "ko-KR"
                            ),
                            subscription: r.table.subscription,
                            data: r.data,
                        })),
                    });

                    if (result.list.length === 0) {
                        addLog(
                            "info",
                            "â„¹ï¸ No subscription records found",
                            "Create a record with 'Is Subscription Record' and 'Upload to Feed' checked"
                        );
                    }
                } catch (error) {
                    addLog(
                        "error",
                        "âŒ Debug Feed Records Failed",
                        error.message
                    );
                }
            }

            // ==================== ACCESS ====================
            async function grantPrivateAccess() {
                try {
                    const recordId = document
                        .getElementById("accessRecordId")
                        .value.trim();
                    const userId = document
                        .getElementById("accessUserId")
                        .value.trim();

                    if (!recordId || !userId) {
                        alert("Both Record ID and User ID are required");
                        return;
                    }

                    const result = await skapi.grantPrivateRecordAccess({
                        record_id: recordId,
                        user_id: userId,
                    });
                    addLog("success", "ğŸ” Private Access Granted", result);
                } catch (error) {
                    addLog("error", "âŒ Grant Failed", error.message);
                }
            }

            async function removePrivateAccess() {
                try {
                    const recordId = document
                        .getElementById("accessRecordId")
                        .value.trim();
                    const userId = document
                        .getElementById("accessUserId")
                        .value.trim();

                    if (!recordId || !userId) {
                        alert("Both Record ID and User ID are required");
                        return;
                    }

                    const result = await skapi.removePrivateRecordAccess({
                        record_id: recordId,
                        user_id: userId,
                    });
                    addLog("success", "ğŸ” Private Access Removed", result);
                } catch (error) {
                    addLog("error", "âŒ Remove Failed", error.message);
                }
            }

            async function listPrivateAccess() {
                try {
                    const recordId = document
                        .getElementById("accessRecordId")
                        .value.trim();
                    const userId = document
                        .getElementById("accessUserId")
                        .value.trim();

                    if (!recordId && !userId) {
                        alert("At least Record ID or User ID is required");
                        return;
                    }

                    const params = {};
                    if (recordId) params.record_id = recordId;
                    if (userId) params.user_id = userId;

                    const result = await skapi.listPrivateRecordAccess(params);
                    addLog("success", "ğŸ” Private Access List", result);
                } catch (error) {
                    addLog("error", "âŒ List Failed", error.message);
                }
            }

            // ==================== INFO ====================
            async function getTables() {
                try {
                    const result = await skapi.getTables();
                    addLog("success", "ğŸ“Š Tables", result);
                } catch (error) {
                    addLog("error", "âŒ Get Tables Failed", error.message);
                }
            }

            async function getIndexes() {
                try {
                    const result = await skapi.getIndexes();
                    addLog("success", "ğŸ“Š Indexes", result);
                } catch (error) {
                    addLog("error", "âŒ Get Indexes Failed", error.message);
                }
            }

            async function getTags() {
                try {
                    const result = await skapi.getTags();
                    addLog("success", "ğŸ“Š Tags", result);
                } catch (error) {
                    addLog("error", "âŒ Get Tags Failed", error.message);
                }
            }

            async function getUniqueIds() {
                try {
                    const prefix = document
                        .getElementById("uniqueIdPrefix")
                        .value.trim();
                    const params = prefix
                        ? {
                              unique_id: prefix,
                              condition: ">=",
                          }
                        : {};

                    const result = await skapi.getUniqueId(params);
                    addLog("success", "ğŸ†” Unique IDs", result);
                } catch (error) {
                    addLog("error", "âŒ Get Unique IDs Failed", error.message);
                }
            }

            async function getIndexInfo() {
                try {
                    const tableName = document
                        .getElementById("indexTableName")
                        .value.trim();
                    const indexName = document
                        .getElementById("indexName")
                        .value.trim();

                    if (!tableName) {
                        alert("Table name is required");
                        return;
                    }

                    const params = { table: tableName };
                    if (indexName) params.index = indexName;

                    const result = await skapi.getIndexes(params);
                    addLog("success", "ğŸ“Š Index Information", result);
                } catch (error) {
                    addLog("error", "âŒ Get Index Info Failed", error.message);
                }
            }
        </script>
    </body>
</html>
