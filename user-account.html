<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Skapi User Account Test</title>
        <link rel="stylesheet" href="style.css" />
        <style>
            body {
                font-family: Arial, sans-serif;
                max-width: 1400px;
                margin: 0 auto;
                padding: 20px;
            }
            .container {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 20px;
                margin-top: 20px;
            }
            .panel {
                border: 1px solid #ccc;
                border-radius: 8px;
                padding: 20px;
                background-color: #f9f9f9;
            }
            .panel h2 {
                margin-top: 0;
                border-bottom: 2px solid #007bff;
                padding-bottom: 10px;
            }
            .panel h3 {
                margin-top: 15px;
                color: #007bff;
                font-size: 16px;
            }
            #resultLog {
                height: 500px;
                overflow-y: auto;
                background-color: #fff;
                border: 1px solid #ddd;
                border-radius: 4px;
                padding: 10px;
                font-family: monospace;
                font-size: 12px;
            }
            .result-item {
                margin-bottom: 10px;
                padding: 8px;
                border-radius: 4px;
                border-left: 3px solid #ccc;
            }
            .result-item.success {
                background-color: #d4edda;
                border-left-color: #28a745;
            }
            .result-item.error {
                background-color: #f8d7da;
                border-left-color: #dc3545;
            }
            .result-item.info {
                background-color: #d1ecf1;
                border-left-color: #17a2b8;
            }
            button {
                padding: 8px 16px;
                margin: 5px 5px 5px 0;
                border: none;
                border-radius: 4px;
                background-color: #007bff;
                color: white;
                font-size: 14px;
                cursor: pointer;
            }
            button:hover {
                background-color: #0056b3;
            }
            button.success {
                background-color: #28a745;
            }
            button.success:hover {
                background-color: #218838;
            }
            button.danger {
                background-color: #dc3545;
            }
            button.danger:hover {
                background-color: #c82333;
            }
            input[type="text"],
            input[type="email"],
            input[type="password"],
            textarea {
                width: 100%;
                padding: 8px;
                border: 1px solid #ccc;
                border-radius: 4px;
                font-size: 14px;
                box-sizing: border-box;
            }
            .form-group {
                margin-bottom: 15px;
            }
            .form-group label {
                display: block;
                margin-bottom: 5px;
                font-weight: bold;
                font-size: 13px;
            }
            .user-info {
                background-color: #e9ecef;
                padding: 10px;
                border-radius: 4px;
                margin-bottom: 15px;
                font-size: 14px;
            }
            .tabs {
                display: flex;
                border-bottom: 2px solid #ddd;
                margin-bottom: 15px;
            }
            .tab {
                padding: 10px 20px;
                cursor: pointer;
                border: none;
                background: none;
                font-size: 14px;
                font-weight: bold;
                color: #666;
                margin: 0;
                border-radius: 0;
            }
            .tab.active {
                color: #007bff;
                border-bottom: 2px solid #007bff;
            }
            .tab-content {
                display: none;
            }
            .tab-content.active {
                display: block;
            }
        </style>
    </head>
    <body>
        <a class="btn home" href="index.html">í™ˆìœ¼ë¡œ</a>
        <h1>ğŸ‘¤ Skapi User Account Test</h1>

        <div class="user-info">
            <strong>Logged User:</strong>
            <span id="loggedUser">Not logged in</span>
        </div>

        <!-- Test Guide Panel -->
        <div
            class="panel"
            style="background-color: #fff3cd; border-color: #ffc107"
        >
            <h2>ğŸ“‹ í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ</h2>

            <details open>
                <summary
                    style="
                        cursor: pointer;
                        font-weight: bold;
                        margin-bottom: 10px;
                    "
                >
                    ğŸ“§ E-Mail Verification í…ŒìŠ¤íŠ¸
                </summary>
                <ol style="line-height: 1.8">
                    <li>
                        <strong>ì¸ì¦ ì½”ë“œ ì „ì†¡</strong>
                        <ul>
                            <li>
                                ë¡œê·¸ì¸ëœ ìƒíƒœì—ì„œ "Email Verification" íƒ­ ì´ë™
                            </li>
                            <li>"Send Verification Code" ë²„íŠ¼ í´ë¦­</li>
                            <li>âœ… ì´ë©”ì¼ ìˆ˜ì‹ í•¨ì—ì„œ ì¸ì¦ ì½”ë“œ í™•ì¸</li>
                            <li>â±ï¸ ì½”ë“œëŠ” ì¼ì • ì‹œê°„ í›„ ë§Œë£Œë¨</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ì´ë©”ì¼ ì¸ì¦ ì™„ë£Œ</strong>
                        <ul>
                            <li>
                                Verification Code ì…ë ¥ë€ì— ì´ë©”ì¼ì—ì„œ ë°›ì€ ì½”ë“œ
                                ì…ë ¥
                            </li>
                            <li>"Verify Email" ë²„íŠ¼ í´ë¦­</li>
                            <li>âœ… ì¸ì¦ ì„±ê³µ ë©”ì‹œì§€ í™•ì¸</li>
                            <li>
                                "Get My Profile" â†’
                                <code>email_verified</code> í™•ì¸
                            </li>
                        </ul>
                    </li>
                </ol>

                <div
                    style="
                        background-color: #fff3cd;
                        border: 1px solid #ffc107;
                        border-radius: 4px;
                        padding: 10px;
                        margin-top: 10px;
                    "
                >
                    <strong>ğŸ’¡ ì¸ì¦ëœ ì´ë©”ì¼ì˜ í˜œíƒ:</strong>
                    <ul style="margin: 5px 0">
                        <li>ë¹„ë°€ë²ˆí˜¸ ë¶„ì‹¤ ì‹œ ì¬ì„¤ì • ê°€ëŠ¥</li>
                        <li>ì„œë¹„ìŠ¤ ë‰´ìŠ¤ë ˆí„° ìˆ˜ì‹  ê°€ëŠ¥</li>
                        <li>ë¹„í™œì„±í™”ëœ ê³„ì • ë³µêµ¬ ê°€ëŠ¥</li>
                        <li>ë‹¤ë¥¸ ì‚¬ìš©ìì—ê²Œ ì´ë©”ì¼ ê³µê°œ ì„ íƒ ê°€ëŠ¥</li>
                    </ul>
                </div>

                <div
                    style="
                        background-color: #f8d7da;
                        border: 1px solid #dc3545;
                        border-radius: 4px;
                        padding: 10px;
                        margin-top: 10px;
                    "
                >
                    <strong>âš ï¸ ì£¼ì˜ì‚¬í•­:</strong>
                    <ul style="margin: 5px 0">
                        <li>ì´ë©”ì¼ ì£¼ì†Œ ë³€ê²½ ì‹œ ì¸ì¦ ìƒíƒœê°€ ì´ˆê¸°í™”ë¨</li>
                        <li>
                            Signup confirmationì´ í™œì„±í™”ëœ ê²½ìš° ê°€ì… ì‹œ ìë™
                            ì¸ì¦ë¨
                        </li>
                    </ul>
                </div>
            </details>

            <details style="margin-top: 15px">
                <summary
                    style="
                        cursor: pointer;
                        font-weight: bold;
                        margin-bottom: 10px;
                    "
                >
                    ğŸ” Change Password í…ŒìŠ¤íŠ¸
                </summary>
                <ol style="line-height: 1.8">
                    <li>
                        <strong>ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</strong>
                        <ul>
                            <li>"Change Password" íƒ­ ì´ë™</li>
                            <li>Current Password ì…ë ¥</li>
                            <li>New Password ì…ë ¥ (ìµœì†Œ 6ì)</li>
                            <li>"Change Password" í´ë¦­</li>
                            <li>âœ… ë³€ê²½ ì„±ê³µ ë©”ì‹œì§€ í™•ì¸</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ë³€ê²½ëœ ë¹„ë°€ë²ˆí˜¸ë¡œ ì¬ë¡œê·¸ì¸</strong>
                        <ul>
                            <li>ë¡œê·¸ì•„ì›ƒ í›„ ìƒˆ ë¹„ë°€ë²ˆí˜¸ë¡œ ë¡œê·¸ì¸</li>
                            <li>âœ… ë¡œê·¸ì¸ ì„±ê³µ í™•ì¸</li>
                        </ul>
                    </li>
                </ol>
            </details>

            <details style="margin-top: 15px">
                <summary
                    style="
                        cursor: pointer;
                        font-weight: bold;
                        margin-bottom: 10px;
                    "
                >
                    ğŸ‘¤ Update Profile í…ŒìŠ¤íŠ¸
                </summary>
                <ol style="line-height: 1.8">
                    <li>
                        <strong>í”„ë¡œí•„ ì •ë³´ ì—…ë°ì´íŠ¸</strong>
                        <ul>
                            <li>"Update Profile" íƒ­ ì´ë™</li>
                            <li>Name, Email, Gender ë“± ì •ë³´ ì…ë ¥</li>
                            <li>Profile Picture ì„ íƒ (ì„ íƒì‚¬í•­)</li>
                            <li>"Update Profile" í´ë¦­</li>
                            <li>âœ… ì—…ë°ì´íŠ¸ ì„±ê³µ ë©”ì‹œì§€ í™•ì¸</li>
                        </ul>
                    </li>
                    <li>
                        <strong>í”„ë¡œí•„ í™•ì¸</strong>
                        <ul>
                            <li>"Get My Profile" ë²„íŠ¼ í´ë¦­</li>
                            <li>âœ… ë³€ê²½ëœ ì •ë³´ í™•ì¸</li>
                        </ul>
                    </li>
                </ol>
            </details>

            <details style="margin-top: 15px">
                <summary
                    style="
                        cursor: pointer;
                        font-weight: bold;
                        margin-bottom: 10px;
                    "
                >
                    ğŸ—‘ï¸ Disable/Recover Account í…ŒìŠ¤íŠ¸
                </summary>
                <ol style="line-height: 1.8">
                    <li>
                        <strong>ê³„ì • ë¹„í™œì„±í™”</strong>
                        <ul>
                            <li>
                                âš ï¸ <strong>ì£¼ì˜:</strong> í…ŒìŠ¤íŠ¸ ê³„ì •ìœ¼ë¡œë§Œ ì§„í–‰
                            </li>
                            <li>"Disable/Recover" íƒ­ ì´ë™</li>
                            <li>"Disable My Account" í´ë¦­</li>
                            <li>âœ… ê³„ì • ë¹„í™œì„±í™”ë¨ (ìë™ ë¡œê·¸ì•„ì›ƒ)</li>
                        </ul>
                    </li>
                    <li>
                        <strong>ê³„ì • ë³µêµ¬</strong>
                        <ul>
                            <li>
                                ë¡œê·¸ì¸ í˜ì´ì§€ì—ì„œ ë¹„í™œì„±í™”ëœ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸
                                ì‹œë„
                            </li>
                            <li>"ì´ë©”ì¼ ì¸ì¦ëœ ê³„ì •"ì¸ ê²½ìš° ë³µêµ¬ ê°€ëŠ¥</li>
                            <li>ë³µêµ¬ ì½”ë“œ ì´ë©”ì¼ ìˆ˜ì‹ </li>
                            <li>ì½”ë“œ ì…ë ¥í•˜ì—¬ ê³„ì • ë³µêµ¬</li>
                        </ul>
                    </li>
                </ol>
            </details>
        </div>

        <div class="container">
            <!-- Left Panel: Account Operations -->
            <div class="panel">
                <h2>âš™ï¸ Account Operations</h2>

                <div class="tabs">
                    <button class="tab active" onclick="switchTab('email')">
                        Email Verification
                    </button>
                    <button class="tab" onclick="switchTab('password')">
                        Change Password
                    </button>
                    <button class="tab" onclick="switchTab('profile')">
                        Update Profile
                    </button>
                    <button class="tab" onclick="switchTab('disable')">
                        Disable/Recover
                    </button>
                </div>

                <!-- EMAIL VERIFICATION TAB -->
                <div id="tab-email" class="tab-content active">
                    <h3>ğŸ“§ Email Verification</h3>

                    <div
                        style="
                            background-color: #d1ecf1;
                            padding: 10px;
                            border-radius: 4px;
                            margin-bottom: 15px;
                            font-size: 13px;
                        "
                    >
                        ğŸ’¡ <strong>Tip:</strong> ì¸ì¦ ì½”ë“œë¥¼ ë¨¼ì € ì´ë©”ì¼ë¡œ ë°›ì€
                        í›„, ì½”ë“œë¥¼ ì…ë ¥í•˜ì—¬ ì¸ì¦ì„ ì™„ë£Œí•˜ì„¸ìš”.
                    </div>

                    <div class="form-group">
                        <button
                            onclick="sendVerificationCode()"
                            class="success"
                        >
                            ğŸ“¤ Send Verification Code
                        </button>
                    </div>

                    <hr />

                    <div class="form-group">
                        <label>Verification Code:</label>
                        <input
                            type="text"
                            id="verificationCode"
                            placeholder="ì´ë©”ì¼ì—ì„œ ë°›ì€ ì¸ì¦ ì½”ë“œ ì…ë ¥"
                        />
                    </div>

                    <button onclick="verifyEmailWithCode()">
                        âœ… Verify Email
                    </button>
                </div>

                <!-- CHANGE PASSWORD TAB -->
                <div id="tab-password" class="tab-content">
                    <h3>ğŸ” Change Password</h3>

                    <div class="form-group">
                        <label>Current Password:</label>
                        <input
                            type="password"
                            id="currentPassword"
                            placeholder="í˜„ì¬ ë¹„ë°€ë²ˆí˜¸"
                        />
                    </div>

                    <div class="form-group">
                        <label>New Password:</label>
                        <input
                            type="password"
                            id="newPassword"
                            placeholder="ìƒˆ ë¹„ë°€ë²ˆí˜¸ (ìµœì†Œ 6ì)"
                        />
                    </div>

                    <button onclick="changePassword()">Change Password</button>
                </div>

                <!-- UPDATE PROFILE TAB -->
                <div id="tab-profile" class="tab-content">
                    <h3>ğŸ‘¤ Update Profile</h3>

                    <div
                        style="
                            background-color: #f8d7da;
                            padding: 10px;
                            border-radius: 4px;
                            margin-bottom: 15px;
                            font-size: 13px;
                        "
                    >
                        âš ï¸ <strong>ì£¼ì˜:</strong> ì´ë©”ì¼ ë³€ê²½ ì‹œ ë¡œê·¸ì¸ ì´ë©”ì¼ë„
                        ë³€ê²½ë˜ë©°, ì´ë©”ì¼ ì¸ì¦ ìƒíƒœê°€ í•´ì œë©ë‹ˆë‹¤.
                    </div>

                    <form id="profileForm" onsubmit="updateProfile(event)">
                        <div class="form-group">
                            <label>Name:</label>
                            <input
                                type="text"
                                name="name"
                                placeholder="Your name"
                            />
                        </div>

                        <div class="form-group">
                            <label>Nickname:</label>
                            <input
                                type="text"
                                name="nickname"
                                placeholder="Your nickname"
                            />
                        </div>

                        <div class="form-group">
                            <label>Email:</label>
                            <input
                                type="email"
                                name="email"
                                placeholder="your@email.com"
                            />
                            <label style="font-weight: normal; font-size: 12px">
                                <input
                                    type="checkbox"
                                    name="email_public"
                                    value="true"
                                />
                                Make email public
                            </label>
                        </div>

                        <div class="form-group">
                            <label>Phone Number:</label>
                            <input
                                type="text"
                                name="phone_number"
                                placeholder="+821012345678"
                            />
                            <label style="font-weight: normal; font-size: 12px">
                                <input
                                    type="checkbox"
                                    name="phone_number_public"
                                    value="true"
                                />
                                Make phone number public
                            </label>
                        </div>

                        <div class="form-group">
                            <label>Gender:</label>
                            <select name="gender">
                                <option value="">Select gender</option>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                                <option value="other">Other</option>
                            </select>
                            <label style="font-weight: normal; font-size: 12px">
                                <input
                                    type="checkbox"
                                    name="gender_public"
                                    value="true"
                                />
                                Make gender public
                            </label>
                        </div>

                        <div class="form-group">
                            <label>Birthdate:</label>
                            <input
                                type="text"
                                name="birthdate"
                                placeholder="YYYY-MM-DD"
                            />
                            <label style="font-weight: normal; font-size: 12px">
                                <input
                                    type="checkbox"
                                    name="birthdate_public"
                                    value="true"
                                />
                                Make birthdate public
                            </label>
                        </div>

                        <div class="form-group">
                            <label>Address:</label>
                            <textarea
                                name="address"
                                rows="3"
                                placeholder="Your address"
                            ></textarea>
                            <label style="font-weight: normal; font-size: 12px">
                                <input
                                    type="checkbox"
                                    name="address_public"
                                    value="true"
                                />
                                Make address public
                            </label>
                        </div>

                        <div class="form-group">
                            <label>Profile Picture URL:</label>
                            <input
                                type="text"
                                name="picture"
                                placeholder="https://example.com/profile.jpg"
                            />
                            <small
                                style="
                                    color: #666;
                                    display: block;
                                    margin-top: 5px;
                                "
                            >
                                ğŸ’¡ Tip: íŒŒì¼ì€ Databaseì˜ Files íƒ­ì—ì„œ ë¨¼ì €
                                ì—…ë¡œë“œí•˜ê³  URLì„ ì—¬ê¸°ì— ì…ë ¥í•˜ì„¸ìš”.
                            </small>
                        </div>

                        <div class="form-group">
                            <label>Profile Page URL:</label>
                            <input
                                type="text"
                                name="profile"
                                placeholder="https://yourprofile.com"
                            />
                        </div>

                        <div class="form-group">
                            <label>Website URL:</label>
                            <input
                                type="text"
                                name="website"
                                placeholder="https://yourwebsite.com"
                            />
                        </div>

                        <div class="form-group">
                            <label>Misc (ë³¸ì¸ë§Œ ë³´ëŠ” ë©”ëª¨):</label>
                            <textarea
                                name="misc"
                                rows="3"
                                placeholder="ê°œì¸ ë©”ëª¨ (ë‹¤ë¥¸ ì‚¬ìš©ìì—ê²Œ ë³´ì´ì§€ ì•ŠìŒ)"
                            ></textarea>
                        </div>

                        <button type="submit" class="success">
                            Update Profile
                        </button>
                    </form>
                </div>

                <!-- DISABLE/RECOVER TAB -->
                <div id="tab-disable" class="tab-content">
                    <h3>ğŸ—‘ï¸ Disable/Recover Account</h3>

                    <div
                        style="
                            background-color: #f8d7da;
                            padding: 10px;
                            border-radius: 4px;
                            margin-bottom: 15px;
                            font-size: 13px;
                        "
                    >
                        âš ï¸ <strong>ê²½ê³ :</strong> ê³„ì •ì„ ë¹„í™œì„±í™”í•˜ë©´ ìë™ìœ¼ë¡œ
                        ë¡œê·¸ì•„ì›ƒë˜ë©°, ì´ë©”ì¼ ì¸ì¦ì´ ë˜ì–´ìˆì–´ì•¼ ë³µêµ¬ ê°€ëŠ¥í•©ë‹ˆë‹¤.
                    </div>

                    <button onclick="disableAccount()" class="danger">
                        Disable My Account
                    </button>

                    <hr />

                    <h3>ë³µêµ¬ (Recover Account)</h3>
                    <p style="font-size: 13px; color: #666">
                        ê³„ì •ì´ ë¹„í™œì„±í™”ëœ ê²½ìš°, ë¡œê·¸ì¸ ì‹œë„ ì‹œ ë³µêµ¬ í”„ë¡œì„¸ìŠ¤ê°€
                        ì‹œì‘ë©ë‹ˆë‹¤.
                    </p>
                </div>
            </div>

            <!-- Right Panel: Profile Info -->
            <div class="panel">
                <h2>ğŸ“Š User Information</h2>

                <button onclick="getMyProfile()">Get My Profile</button>

                <div id="profileInfo" style="margin-top: 15px; display: none">
                    <h3>Current Profile:</h3>
                    <div
                        id="profileContent"
                        style="
                            background-color: #fff;
                            padding: 10px;
                            border-radius: 4px;
                            border: 1px solid #ddd;
                        "
                    ></div>
                </div>
            </div>
        </div>

        <!-- Result Log Panel (Full Width) -->
        <div class="panel" style="margin-top: 20px">
            <h2>ğŸ“‹ Result Log</h2>
            <button onclick="clearLog()">Clear Log</button>
            <div id="resultLog"></div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/skapi-js@latest/dist/skapi.js"></script>
        <script src="service.js"></script>
        <script>
            // Tab switching
            function switchTab(tab) {
                document
                    .querySelectorAll(".tab-content")
                    .forEach((tc) => tc.classList.remove("active"));
                document
                    .querySelectorAll(".tab")
                    .forEach((t) => t.classList.remove("active"));
                document.getElementById("tab-" + tab).classList.add("active");
                event.target.classList.add("active");
            }

            // Log functions
            function addLog(type, title, data) {
                const log = document.getElementById("resultLog");
                const item = document.createElement("div");
                item.className = `result-item ${type}`;

                const time = new Date().toLocaleTimeString("ko-KR");
                item.innerHTML = `
                <div style="font-weight: bold; margin-bottom: 5px;">${title}</div>
                <pre style="margin: 0; white-space: pre-wrap; word-wrap: break-word;">${JSON.stringify(
                    data,
                    null,
                    2
                )}</pre>
                <div style="font-size: 10px; color: #666; margin-top: 5px;">${time}</div>
            `;

                log.insertBefore(item, log.firstChild);
            }

            function clearLog() {
                document.getElementById("resultLog").innerHTML = "";
            }

            // ==================== EMAIL VERIFICATION ====================
            async function sendVerificationCode() {
                try {
                    const result = await skapi.verifyEmail();
                    addLog("success", "ğŸ“¤ Verification Code Sent", result);
                    alert(
                        "ì¸ì¦ ì½”ë“œê°€ ì´ë©”ì¼ë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ë©”ì¼ì„ í™•ì¸í•˜ì„¸ìš”."
                    );
                } catch (error) {
                    addLog("error", "âŒ Send Failed", error.message);
                }
            }

            async function verifyEmailWithCode() {
                try {
                    const code = document
                        .getElementById("verificationCode")
                        .value.trim();
                    if (!code) {
                        alert("ì¸ì¦ ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
                        return;
                    }

                    const result = await skapi.verifyEmail({ code });
                    addLog("success", "âœ… Email Verified", result);
                    alert("ì´ë©”ì¼ ì¸ì¦ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!");
                    document.getElementById("verificationCode").value = "";
                } catch (error) {
                    addLog("error", "âŒ Verification Failed", error.message);
                }
            }

            // ==================== CHANGE PASSWORD ====================
            async function changePassword() {
                try {
                    const currentPassword =
                        document.getElementById("currentPassword").value;
                    const newPassword =
                        document.getElementById("newPassword").value;

                    if (!currentPassword || !newPassword) {
                        alert("í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ì™€ ìƒˆ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•˜ì„¸ìš”.");
                        return;
                    }

                    const result = await skapi.changePassword({
                        current_password: currentPassword,
                        new_password: newPassword,
                    });

                    addLog("success", "ğŸ” Password Changed", result);
                    alert("ë¹„ë°€ë²ˆí˜¸ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.");
                    document.getElementById("currentPassword").value = "";
                    document.getElementById("newPassword").value = "";
                } catch (error) {
                    addLog("error", "âŒ Change Password Failed", error.message);
                }
            }

            // ==================== UPDATE PROFILE ====================
            async function updateProfile(event) {
                event.preventDefault();

                try {
                    const form = event.target;
                    const formData = new FormData(form);
                    const params = {};

                    // ëª¨ë“  í•„ë“œ ìˆ˜ì§‘ (ë¹ˆ ê°’ë„ í¬í•¨)
                    for (let [key, value] of formData.entries()) {
                        // ì²´í¬ë°•ìŠ¤ëŠ” true/falseë¡œ ì²˜ë¦¬
                        if (key.endsWith("_public")) {
                            params[key] = form.querySelector(
                                `[name="${key}"]`
                            ).checked;
                        } else if (value.trim()) {
                            // ë¹ˆ ë¬¸ìì—´ì´ ì•„ë‹Œ ê²½ìš°ë§Œ ì¶”ê°€
                            params[key] = value;
                        }
                    }

                    // public ì²´í¬ë°•ìŠ¤ë“¤ì´ ì²´í¬ë˜ì§€ ì•Šì€ ê²½ìš° falseë¡œ ëª…ì‹œì ìœ¼ë¡œ ì„¤ì •
                    const publicFields = [
                        "email_public",
                        "phone_number_public",
                        "address_public",
                        "gender_public",
                        "birthdate_public",
                    ];
                    publicFields.forEach((field) => {
                        if (!(field in params)) {
                            params[field] = false;
                        }
                    });

                    addLog("info", "ğŸ”„ Updating Profile with params", params);
                    const result = await skapi.updateProfile(params);

                    addLog("success", "âœ… Profile Updated", result);
                    alert("í”„ë¡œí•„ì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.");
                } catch (error) {
                    addLog("error", "âŒ Update Failed", error.message);
                }
            }

            // ==================== GET PROFILE ====================
            async function getMyProfile() {
                try {
                    const result = await skapi.getProfile();

                    addLog("info", "ğŸ“Š My Profile", result);

                    // Display profile info
                    const profileInfo = document.getElementById("profileInfo");
                    const profileContent =
                        document.getElementById("profileContent");

                    profileContent.innerHTML = `
                        <p><strong>User ID:</strong> ${result.user_id}</p>
                        <p><strong>Email:</strong> ${result.email} ${
                        result.email_public ? "ğŸŒ" : "ğŸ”’"
                    }</p>
                        <p><strong>Email Verified:</strong> ${
                            result.email_verified ? "âœ… Yes" : "âŒ No"
                        }</p>
                        <p><strong>Name:</strong> ${result.name || "N/A"}</p>
                        <p><strong>Nickname:</strong> ${
                            result.nickname || "N/A"
                        }</p>
                        <p><strong>Phone:</strong> ${
                            result.phone_number || "N/A"
                        } ${result.phone_number_public ? "ğŸŒ" : "ğŸ”’"}</p>
                        <p><strong>Gender:</strong> ${result.gender || "N/A"} ${
                        result.gender_public ? "ğŸŒ" : "ğŸ”’"
                    }</p>
                        <p><strong>Birthdate:</strong> ${
                            result.birthdate || "N/A"
                        } ${result.birthdate_public ? "ğŸŒ" : "ğŸ”’"}</p>
                        <p><strong>Address:</strong> ${
                            result.address || "N/A"
                        } ${result.address_public ? "ğŸŒ" : "ğŸ”’"}</p>
                        <p><strong>Picture:</strong> ${
                            result.picture
                                ? `<a href="${result.picture}" target="_blank">View</a>`
                                : "N/A"
                        }</p>
                        <p><strong>Profile URL:</strong> ${
                            result.profile
                                ? `<a href="${result.profile}" target="_blank">${result.profile}</a>`
                                : "N/A"
                        }</p>
                        <p><strong>Website:</strong> ${
                            result.website
                                ? `<a href="${result.website}" target="_blank">${result.website}</a>`
                                : "N/A"
                        }</p>
                        <p><strong>Misc:</strong> ${result.misc || "N/A"}</p>
                        <p><strong>Account Created:</strong> ${new Date(
                            result.timestamp
                        ).toLocaleString("ko-KR")}</p>
                        <p style="font-size: 11px; color: #666; margin-top: 10px;">ğŸŒ = Public, ğŸ”’ = Private</p>
                    `;

                    profileInfo.style.display = "block";
                } catch (error) {
                    addLog("error", "âŒ Get Profile Failed", error.message);
                }
            }

            // ==================== DISABLE ACCOUNT ====================
            async function disableAccount() {
                try {
                    const confirmed = confirm(
                        "ì •ë§ë¡œ ê³„ì •ì„ ë¹„í™œì„±í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ë©”ì¼ ì¸ì¦ì´ ë˜ì–´ìˆì–´ì•¼ ë³µêµ¬ ê°€ëŠ¥í•©ë‹ˆë‹¤."
                    );
                    if (!confirmed) return;

                    const result = await skapi.disableAccount();
                    addLog("success", "ğŸ—‘ï¸ Account Disabled", result);
                    alert(
                        "ê³„ì •ì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤. ìë™ìœ¼ë¡œ ë¡œê·¸ì•„ì›ƒë©ë‹ˆë‹¤."
                    );
                } catch (error) {
                    addLog("error", "âŒ Disable Failed", error.message);
                }
            }

            // Check login status on page load
            window.addEventListener("load", async () => {
                try {
                    const user = await skapi.getProfile();
                    document.getElementById("loggedUser").textContent =
                        user.email;
                } catch (error) {
                    document.getElementById("loggedUser").textContent =
                        "Not logged in";
                }
            });
        </script>
    </body>
</html>
